<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Finite Difference Computing with Partial Differential Equations">
<meta name="keywords" content="vibration ODE,oscillations,mechanical vibrations,period (of oscillations),frequency (of oscillations),Hz (unit),mesh finite differences,mesh function,centered difference,finite differences centered,vectorization,test function,pytest,nose,verification hand calculations,unit testing,verification polynomial solutions,verification convergence rates,slope marker (in convergence plots),making movies,animation,WebM (video format),Ogg (video format),MP4 (video format),Flash (video format),video formats,HTML5 video tag,error global,stability criterion,phase plane plot,mechanical energy,energy principle,forward-backward Euler-Cromer scheme,Euler-Cromer scheme,symplectic scheme,Stoermer-Verlet algorithm,staggered mesh,staggered Euler-Cromer scheme,alternating mesh,nonlinear restoring force,nonlinear spring,forced vibrations,geometric mean,averaging geometric,DOF (degree of freedom),resonance,waves on a string,wave equation 1D,wave equation 1D, finite difference method,mesh finite differences,stencil 1D wave equation,mesh function,wave equation 1D, implementation,callback function,verification polynomial solution,nose,pytest,unit testing,test function,closure,vectorization,parallelism,scalar code,vectorization,array computing,array slices,slice,lambda function (Python),Neumann conditions,Dirichlet conditions,homogeneous Neumann conditions,homogeneous Dirichlet conditions,boundary conditions Neumann,boundary conditions Dirichlet,stencil Neumann boundary,index set notation,geometric mean,arithmetic mean,harmonic average,averaging geometric,averaging arithmetic,averaging harmonic,radiation condition,open boundary condition,boundary condition open (radiation),periodic boundary conditions,boundary conditions periodic,wave equation 1D, analytical properties,Fourier series,Fourier transform,discrete Fourier transform,wave equation 1D, exact numerical solution,Courant number,stability criterion,wave equation 1D, stability,wave equation 2D, implementation,index set notation,diffusion equation 1D,heat equation,diffusion coefficient,diffusion equation diffusion coefficient,diffusion equation stationary solution,stationary solution,Laplace equation,diffusion equation  1D, explicit scheme,diffusion equation  1D, initial boundary value problem,diffusion equation  1D, initial condition,diffusion equation  1D, boundary condition,diffusion equation source term,explicit discretization methods,diffusion equation  1D, Forward Euler scheme,domain,mesh points,mesh function,forward difference approximation,central difference approximation,diffusion equation  1D, discrete equations,diffusion equation  1D, Fourier number,diffusion equation  1D, mesh Fourier number,dimensionless number,diffusion equation  1D, implementation (FE),diffusion equation  1D, verification (FE),diffusion equation  1D, numerical experiments,diffusion equation  1D, implicit schemes,diffusion equation  1D, verification (BE),diffusion equation  1D, tridiagonal matrix,diffusion equation  1D, Crank-Nicolson scheme,diffusion equation  1D, verification (CN),diffusion equation  1D, theta rule,amplification factor,diffusion coefficient non-constant,diffusion equation  1D, Implementation,diffusion equation stationary solution,diffusion coefficient  piecewise constant,diffusion equation  implementation,diffusion equation axi-symmetric diffusion,diffusion equation spherically-symmetric diffusion,diffusion equation 2D,diffusion equation 2D, numbering of mesh points,diffusion equation 2D, sparse matrix,diffusion equation 2D, banded matrix,diffusion equation 2D, implementation,diffusion equation 2D, verification (exact num. sol.),diffusion equation 2D, verification (conv. rates),diffusion equation 2D, implementation (sparse),Jacobi method,relaxation,Gauss-Seidel method,SOR method,red-black numbering,LU factorization,Cholesky factorization,conjugate gradient method,preconditioning,random walk,vectorization,seed (random numbers),verification,diffusion limit of random walk,interrupt a program by Ctrl+c,stochastic difference equation,stochastic ODE,Fokker-Planck equation,Wiener process,energy estimates (diffusion),Richardson iteration,preconditioning,upwind difference,linearization explicit time integration,linearization,Picard iteration,successive substitutions,fixed-point iteration,linearization Picard iteration,linearization successive substitutions,linearization fixed-point iteration,stopping criteria (nonlinear problems),single Picard iteration technique,relaxation (nonlinear equations),stopping criteria (nonlinear problems),continuation method,operator splitting,splitting ODEs,fractional step methods,Strang splitting,continuation method,truncation error general,finite differences backward,truncation error Backward Euler scheme,finite differences forward,truncation error Forward Euler scheme,finite differences centered,truncation error Crank-Nicolson scheme,truncation error table of formulas,decay ODE,correction terms,truncation error correction terms,verification,Cython,declaration of variables in Cython,C extension module,wrapper code,Fortran subroutine,row-major ordering,column-major ordering,Fortran array storage,C/Python array storage">

<title>Finite Difference Computing with Partial Differential Equations</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>



<!-- Tools for embedded Bokeh plots -->
<link rel="stylesheet"
      href="http://cdn.pydata.org/bokeh/release/bokeh-0.9.0.min.css"
      type="text/css" />
<script type="text/javascript"
	src="http://cdn.pydata.org/bokeh/release/bokeh-0.9.0.min.js">
</script>
<script type="text/javascript">
  Bokeh.set_log_level("info");
</script>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Table of contents',
               0,
               'table_of_contents',
               'table_of_contents'),
              (u'Preface', 0, u'ch:preface', u'ch:preface'),
              (u'Simplify, understand, generalize', 3, None, '___sec1'),
              (u'Constructive mathematics', 3, None, '___sec2'),
              (u'All nuts and bolts', 3, None, '___sec3'),
              (u'Python as programming language', 3, None, '___sec4'),
              (u'Program verification', 3, None, '___sec5'),
              (u'Vectorized code', 3, None, '___sec6'),
              (u'Analysis via exact solutions of discrete equations',
               3,
               None,
               '___sec7'),
              (u'Code-inspired mathematical notation', 3, None, '___sec8'),
              (u'Limited scope', 3, None, '___sec9'),
              (u'Independent chapters', 3, None, '___sec10'),
              (u'Supplementary materials', 3, None, '___sec11'),
              (u'Acknowledgments', 3, None, '___sec12'),
              (u'Vibration ODEs', 0, u'ch:vib', u'ch:vib'),
              (u'Finite difference discretization',
               1,
               u'vib:model1',
               u'vib:model1'),
              (u'A basic model for vibrations', 2, None, '___sec15'),
              (u'A centered finite difference scheme',
               2,
               u'vib:ode1:fdm',
               u'vib:ode1:fdm'),
              (u'Step 1: Discretizing the domain', 3, None, '___sec17'),
              (u'Step 2: Fulfilling the equation at discrete time points',
               3,
               None,
               '___sec18'),
              (u'Step 3: Replacing derivatives by finite differences',
               3,
               None,
               '___sec19'),
              (u'Step 4: Formulating a recursive algorithm',
               3,
               None,
               '___sec20'),
              (u'Computing the first step', 3, None, '___sec21'),
              (u'The computational algorithm', 3, None, '___sec22'),
              (u'Operator notation', 3, None, '___sec23'),
              (u'Implementation', 1, u'vib:impl1', u'vib:impl1'),
              (u'Making a solver function',
               2,
               u'vib:impl1:solver',
               u'vib:impl1:solver'),
              (u'Computing $u^{\\prime}$', 3, None, '___sec26'),
              (u'Verification', 2, u'vib:ode1:verify', u'vib:ode1:verify'),
              (u'Manual calculation', 3, None, '___sec28'),
              (u'Testing very simple polynomial solutions',
               3,
               None,
               '___sec29'),
              (u'Checking convergence rates', 3, None, '___sec30'),
              (u'Visualizing convergence rates with slope markers',
               3,
               None,
               '___sec31'),
              (u'Scaled model', 2, None, '___sec32'),
              (u'Visualization of long time simulations',
               1,
               u'vib:ode1:longseries',
               u'vib:ode1:longseries'),
              (u'Using a moving plot window', 2, None, '___sec34'),
              (u'Making animations', 2, u'vib:ode1:anim', u'vib:ode1:anim'),
              (u'Producing standard video formats', 3, None, '___sec36'),
              (u'Playing PNG files in a web browser', 3, None, '___sec37'),
              (u'Making animated GIF files', 3, None, '___sec38'),
              (u'Using Bokeh to compare graphs', 2, None, '___sec39'),
              (u'Using a line-by-line ascii plotter', 2, None, '___sec40'),
              (u'Empirical analysis of the solution',
               2,
               u'vib:ode1:empirical',
               u'vib:ode1:empirical'),
              (u'Analysis of the numerical scheme',
               1,
               u'vib:ode1:analysis',
               u'vib:ode1:analysis'),
              (u'Deriving a solution of the numerical scheme',
               2,
               u'vib:ode1:analysis:solderiv',
               u'vib:ode1:analysis:solderiv'),
              (u'The error in the numerical frequency',
               2,
               u'vib:ode1:analysis:numfreq',
               u'vib:ode1:analysis:numfreq'),
              (u'Empirical convergence rates and adjusted $\\omega$',
               2,
               None,
               '___sec45'),
              (u'Exact discrete solution',
               2,
               u'vib:ode1:analysis:sol',
               u'vib:ode1:analysis:sol'),
              (u'Convergence',
               2,
               u'vib:ode1:analysis:conv',
               u'vib:ode1:analysis:conv'),
              (u'The global error', 2, None, '___sec48'),
              (u'Stability', 2, None, '___sec49'),
              (u'About the accuracy at the stability limit',
               2,
               None,
               '___sec50'),
              (u'Alternative schemes based on 1st-order equations',
               1,
               u'vib:model2x2',
               u'vib:model2x2'),
              (u'The Forward Euler scheme', 2, None, '___sec52'),
              (u'The Backward Euler scheme', 2, None, '___sec53'),
              (u'The Crank-Nicolson scheme',
               2,
               u'vib:undamped:CN',
               u'vib:undamped:CN'),
              (u'Comparison of schemes',
               2,
               u'vib:model2x2:compare',
               u'vib:model2x2:compare'),
              (u'Runge-Kutta methods', 2, None, '___sec56'),
              (u'Analysis of the Forward Euler scheme', 2, None, '___sec57'),
              (u'Energy considerations',
               1,
               u'vib:model1:energy',
               u'vib:model1:energy'),
              (u'Derivation of the energy expression',
               2,
               u'vib:model1:energy:expr',
               u'vib:model1:energy:expr'),
              (u'Energy of the exact solution', 3, None, '___sec60'),
              (u'Growth of energy in the Forward Euler scheme',
               3,
               None,
               '___sec61'),
              (u'An error measure based on energy',
               2,
               u'vib:model1:energy:measure',
               u'vib:model1:energy:measure'),
              (u'The Euler-Cromer method',
               1,
               u'vib:model2x2:EulerCromer',
               u'vib:model2x2:EulerCromer'),
              (u'Forward-backward discretization', 2, None, '___sec64'),
              (u'Equivalence with the scheme for the second-order ODE',
               2,
               u'vib:model2x2:EulerCromer:equiv',
               u'vib:model2x2:EulerCromer:equiv'),
              (u'Implementation',
               2,
               u'vib:model2x2:EulerCromer:impl',
               u'vib:model2x2:EulerCromer:impl'),
              (u'Solver function', 3, None, '___sec67'),
              (u'Verification', 3, None, '___sec68'),
              (u'Using Odespy', 3, None, '___sec69'),
              (u'Convergence rates', 3, None, '___sec70'),
              (u'The Stoermer-Verlet algorithm',
               2,
               u'vib:model2x2:StormerVerlet',
               u'vib:model2x2:StormerVerlet'),
              (u'Staggered mesh', 1, None, '___sec72'),
              (u'The Euler-Cromer scheme on a staggered mesh',
               2,
               u'vib:model2x2:staggered',
               u'vib:model2x2:staggered'),
              (u'Implementation of the scheme on a staggered mesh',
               2,
               None,
               '___sec74'),
              (u'Implementation with integer indices', 3, None, '___sec75'),
              (u'Implementation with half-integer indices',
               3,
               None,
               '___sec76'),
              (u'Exercises and Problems', 1, None, '___sec77'),
              (u'Problem 1.1: Use linear/quadratic functions for verification',
               2,
               u'vib:exer:undamped:verify:linquad',
               u'vib:exer:undamped:verify:linquad'),
              (u'Exercise 1.2: Show linear growth of the phase with time',
               2,
               u'vib:exer:phase:err:growth',
               u'vib:exer:phase:err:growth'),
              (u'Exercise 1.3: Improve the accuracy by adjusting the frequency',
               2,
               u'vib:exer:w:adjust',
               u'vib:exer:w:adjust'),
              (u'Exercise 1.4: See if adaptive methods improve the phase error',
               2,
               u'vib:exer:undamped:adaptive',
               u'vib:exer:undamped:adaptive'),
              (u'Exercise 1.5: Use a Taylor polynomial to compute $u^1$',
               2,
               u'vib:exer:step4b:alt',
               u'vib:exer:step4b:alt'),
              (u'Problem 1.6: Derive and investigate the velocity Verlet method',
               2,
               None,
               '___sec83'),
              (u'Problem 1.7: Find the minimal resolution of an oscillatory function',
               2,
               u'vib:exer:wdt:limit',
               u'vib:exer:wdt:limit'),
              (u'Exercise 1.8: Visualize the accuracy of finite differences for a cosine function',
               2,
               u'vib:exer:fd:exp:plot',
               u'vib:exer:fd:exp:plot'),
              (u'Exercise 1.9: Verify convergence rates of the error in energy',
               2,
               u'vib:exer:energy:convrate',
               u'vib:exer:energy:convrate'),
              (u'Exercise 1.10: Use linear/quadratic functions for verification',
               2,
               u'vib:exer:verify:gen:linear',
               u'vib:exer:verify:gen:linear'),
              (u'Exercise 1.11: Use an exact discrete solution for verification',
               2,
               u'vib:exer:discrete:omega',
               u'vib:exer:discrete:omega'),
              (u'Exercise 1.12: Use analytical solution for convergence rate tests',
               2,
               u'vib:exer:conv:rate',
               u'vib:exer:conv:rate'),
              (u'Exercise 1.13: Investigate the amplitude errors of many solvers',
               2,
               u'vib:exer:undamped:odespy',
               u'vib:exer:undamped:odespy'),
              (u'Problem 1.14: Minimize memory usage of a simple vibration solver',
               2,
               u'vib:exer:memsave0',
               u'vib:exer:memsave0'),
              (u'Problem 1.15: Minimize memory usage of a general vibration solver',
               2,
               u'vib:exer:memsave',
               u'vib:exer:memsave'),
              (u'Exercise 1.16: Implement the Euler-Cromer scheme for the generalized model',
               2,
               u'vib:exer:EC_vs_centered',
               u'vib:exer:EC_vs_centered'),
              (u'Problem 1.17: Interpret $[D_tD_t u]^n$ as a forward-backward difference',
               2,
               u'vib:exer:DtDt:asDtpDtm',
               u'vib:exer:DtDt:asDtpDtm'),
              (u'Exercise 1.18: Analysis of the Euler-Cromer scheme',
               2,
               u'vib:exer:EulerCromer:analysis',
               u'vib:exer:EulerCromer:analysis'),
              (u'Generalization: damping, nonlinearities, and excitation',
               1,
               u'vib:model2',
               u'vib:model2'),
              (u'A centered scheme for linear damping',
               2,
               u'vib:ode2:fdm:flin',
               u'vib:ode2:fdm:flin'),
              (u'A centered scheme for quadratic damping',
               2,
               u'vib:ode2:fdm:fquad',
               u'vib:ode2:fdm:fquad'),
              (u'A forward-backward discretization of the quadratic damping term',
               2,
               None,
               '___sec99'),
              (u'Implementation', 2, u'vib:ode2:solver', u'vib:ode2:solver'),
              (u'Verification', 2, u'vib:ode2:verify', u'vib:ode2:verify'),
              (u'Constant solution', 3, None, '___sec102'),
              (u'Linear solution', 3, None, '___sec103'),
              (u'Quadratic solution', 3, None, '___sec104'),
              (u'Catching bugs', 3, None, '___sec105'),
              (u'Visualization', 2, u'vib:ode2:viz', u'vib:ode2:viz'),
              (u'User interface', 2, u'vib:ode2:ui', u'vib:ode2:ui'),
              (u'The Euler-Cromer scheme for the generalized model',
               2,
               u'vib:ode2:EulerCromer',
               u'vib:ode2:EulerCromer'),
              (u'The Stoermer-Verlet algorithm for the generalized model',
               2,
               u'vib:model2x2:gen:StormerVerlet',
               u'vib:model2x2:gen:StormerVerlet'),
              (u'A staggered Euler-Cromer scheme for a generalized model',
               2,
               u'vib:ode2:staggered',
               u'vib:ode2:staggered'),
              (u'The PEFRL 4th-order accurate algorithm',
               2,
               u'vib:ode2:PEFRL',
               u'vib:ode2:PEFRL'),
              (u'Exercises and Problems', 1, None, '___sec112'),
              (u'Exercise 1.19: Implement the solver via classes',
               2,
               u'vib:exer:gen:class',
               u'vib:exer:gen:class'),
              (u'Problem 1.20: Use a backward difference for the damping term',
               2,
               u'vib:exer:quad:damping:bw',
               u'vib:exer:quad:damping:bw'),
              (u'Exercise 1.21: Use the forward-backward scheme with quadratic damping',
               2,
               u'vib:exer:quad:damping:fwbw',
               u'vib:exer:quad:damping:fwbw'),
              (u'Applications of vibration models',
               1,
               u'vib:app',
               u'vib:app'),
              (u'Oscillating mass attached to a spring',
               2,
               u'vib:app:mass_spring',
               u'vib:app:mass_spring'),
              (u'Scaling', 3, None, '___sec118'),
              (u'The physics', 3, None, '___sec119'),
              (u'General mechanical vibrating system',
               2,
               u'vib:app:mass_gen',
               u'vib:app:mass_gen'),
              (u'Scaling', 3, None, '___sec121'),
              (u'A sliding mass attached to a spring',
               2,
               u'vib:app:mass_sliding',
               u'vib:app:mass_sliding'),
              (u'A jumping washing machine',
               2,
               u'vib:app:washmach',
               u'vib:app:washmach'),
              (u'Motion of a pendulum',
               2,
               u'vib:app:pendulum',
               u'vib:app:pendulum'),
              (u'Simple pendulum', 3, None, '___sec125'),
              (u'Physical pendulum', 3, None, '___sec126'),
              (u'Dynamic free body diagram during pendulum motion',
               2,
               u'vib:app:pendulum_bodydia',
               u'vib:app:pendulum_bodydia'),
              (u'Writing the solver', 3, None, '___sec128'),
              (u'Drawing the free body diagram', 3, None, '___sec129'),
              (u'Making the animated free body diagram',
               3,
               None,
               '___sec130'),
              (u'Motion of an elastic pendulum',
               2,
               u'vib:app:pendulum_elastic',
               u'vib:app:pendulum_elastic'),
              (u'Remarks about an elastic vs a non-elastic pendulum',
               3,
               None,
               '___sec132'),
              (u'Initial conditions', 3, None, '___sec133'),
              (u'The complete ODE problem', 3, None, '___sec134'),
              (u'Scaling', 3, None, '___sec135'),
              (u'Remark on the non-elastic limit', 3, None, '___sec136'),
              (u'Vehicle on a bumpy road',
               2,
               u'vib:app:bumpy',
               u'vib:app:bumpy'),
              (u'Bouncing ball',
               2,
               u'vib:app:bouncing_ball',
               u'vib:app:bouncing_ball'),
              (u'Two-body gravitational problem',
               2,
               u'vib:app:gravitation',
               u'vib:app:gravitation'),
              (u'The governing equations', 3, None, '___sec140'),
              (u'Scaling', 3, None, '___sec141'),
              (u'Solution in a special case: planet orbiting a star',
               3,
               None,
               '___sec142'),
              (u'Electric circuits', 2, None, '___sec143'),
              (u'Exercises', 1, None, '___sec144'),
              (u'Exercise 1.22: Simulate resonance',
               2,
               u'vib:exer:resonance',
               u'vib:exer:resonance'),
              (u'Exercise 1.23: Simulate oscillations of a sliding box',
               2,
               u'vib:exer:sliding_box',
               u'vib:exer:sliding_box'),
              (u'Exercise 1.24: Simulate a bouncing ball',
               2,
               u'vib:exer:bouncing:ball',
               u'vib:exer:bouncing:ball'),
              (u'Exercise 1.25: Simulate a simple pendulum',
               2,
               u'vib:exer:pendulum_simple',
               u'vib:exer:pendulum_simple'),
              (u'Exercise 1.26: Simulate an elastic pendulum',
               2,
               u'vib:exer:pendulum_elastic',
               u'vib:exer:pendulum_elastic'),
              (u'Exercise 1.27: Simulate an elastic pendulum with air resistance',
               2,
               u'vib:exer:pendulum_elastic_drag',
               u'vib:exer:pendulum_elastic_drag'),
              (u'Remarks', 3, None, '___sec151'),
              (u'Exercise 1.28: Implement the PEFRL algorithm',
               2,
               u'vib:exer:gen:PEFRL',
               u'vib:exer:gen:PEFRL'),
              (u'Remarks', 3, None, '___sec153'),
              (u'Wave equations', 0, u'ch:wave', u'ch:wave'),
              (u'Simulation of waves on a string',
               1,
               u'wave:string',
               u'wave:string'),
              (u'Discretizing the domain',
               2,
               u'wave:string:mesh',
               u'wave:string:mesh'),
              (u'Uniform meshes', 3, None, '___sec157'),
              (u'The discrete solution',
               2,
               u'wave:string:numerical:sol',
               u'wave:string:numerical:sol'),
              (u'Fulfilling the equation at the mesh points',
               2,
               u'wave:string:samplingPDE',
               u'wave:string:samplingPDE'),
              (u'Replacing derivatives by finite differences',
               2,
               u'wave:string:fd',
               u'wave:string:fd'),
              (u'Algebraic version of the PDE', 3, None, '___sec161'),
              (u'Interpretation of the equation as a stencil',
               3,
               None,
               '___sec162'),
              (u'Algebraic version of the initial conditions',
               3,
               None,
               '___sec163'),
              (u'Formulating a recursive algorithm',
               2,
               u'wave:string:alg',
               u'wave:string:alg'),
              (u'Sketch of an implementation',
               2,
               u'wave:string:impl',
               u'wave:string:impl'),
              (u'Verification', 1, None, '___sec166'),
              (u'A slightly generalized model problem',
               2,
               u'wave:pde2:fd',
               u'wave:pde2:fd'),
              (u'Using an analytical solution of physical significance',
               2,
               u'wave:pde2:fd:standing:waves',
               u'wave:pde2:fd:standing:waves'),
              (u'Manufactured solution and estimation of convergence rates',
               2,
               u'wave:pde2:fd:MMS',
               u'wave:pde2:fd:MMS'),
              (u'Specifying the solution and computing corresponding data',
               3,
               None,
               '___sec170'),
              (u'Defining a single discretization parameter',
               3,
               None,
               '___sec171'),
              (u'Computing errors', 3, None, '___sec172'),
              (u'Computing rates', 3, None, '___sec173'),
              (u'Constructing an exact solution of the discrete equations',
               2,
               u'wave:pde2:fd:verify:quadratic',
               u'wave:pde2:fd:verify:quadratic'),
              (u'Implementation', 1, u'wave:pde1:impl', u'wave:pde1:impl'),
              (u'Callback function for user-specific actions',
               2,
               u'wave:pde1:impl:useraction',
               u'wave:pde1:impl:useraction'),
              (u'The solver function',
               2,
               u'wave:pde1:impl:solver',
               u'wave:pde1:impl:solver'),
              (u'Verification: exact quadratic solution',
               2,
               u'wave:pde1:impl:verify:quadratic',
               u'wave:pde1:impl:verify:quadratic'),
              (u'Verification: convergence rates',
               2,
               u'wave:pde1:impl:verify:rate',
               u'wave:pde1:impl:verify:rate'),
              (u'Visualization: animating the solution',
               2,
               u'wave:pde1:impl:animate',
               u'wave:pde1:impl:animate'),
              (u'Function for administering the simulation',
               3,
               None,
               '___sec181'),
              (u'Dissection of the code', 3, None, '___sec182'),
              (u'Making movie files', 3, None, '___sec183'),
              (u'Skipping frames for animation speed', 3, None, '___sec184'),
              (u'Running a case',
               2,
               u'wave:pde1:guitar:data',
               u'wave:pde1:guitar:data'),
              (u'Working with a scaled PDE model', 2, None, '___sec186'),
              (u'Vectorization',
               1,
               u'wave:pde1:impl:vec',
               u'wave:pde1:impl:vec'),
              (u'Operations on slices of arrays',
               2,
               u'wave:pde1:impl:vec:slices:basics',
               u'wave:pde1:impl:vec:slices:basics'),
              (u'Finite difference schemes expressed as slices',
               2,
               u'wave:pde1:impl:vec:slices:fdm',
               u'wave:pde1:impl:vec:slices:fdm'),
              (u'Verification',
               2,
               u'wave:pde1:impl:vec:verify:quadratic',
               u'wave:pde1:impl:vec:verify:quadratic'),
              (u'Efficiency measurements', 2, None, '___sec191'),
              (u'Solution 1', 3, None, '___sec192'),
              (u'Solution 2', 3, None, '___sec193'),
              (u'Efficiency experiments', 3, None, '___sec194'),
              (u'Remark on the updating of arrays',
               2,
               u'wave:pde1:impl:ref:switch',
               u'wave:pde1:impl:ref:switch'),
              (u'Exercises', 1, None, '___sec196'),
              (u'Exercise 2.1: Simulate a standing wave',
               2,
               u'wave:exer:standingwave',
               u'wave:exer:standingwave'),
              (u'Remarks', 3, None, '___sec198'),
              (u'Exercise 2.2: Add storage of solution in a user action function',
               2,
               u'wave:exer:store:list',
               u'wave:exer:store:list'),
              (u'Exercise 2.3: Use a class for the user action function',
               2,
               u'wave:exer:store:list:class',
               u'wave:exer:store:list:class'),
              (u'Exercise 2.4: Compare several Courant numbers in one movie',
               2,
               u'wave:exer:multiple:C',
               u'wave:exer:multiple:C'),
              (u'Exercise 2.5: Implementing the solver function as a generator',
               2,
               u'wave:exer:useraction:generator',
               u'wave:exer:useraction:generator'),
              (u'Project 2.6: Calculus with 1D mesh functions',
               2,
               u'wave:exer:mesh1D:calculus',
               u'wave:exer:mesh1D:calculus'),
              (u'Generalization: reflecting boundaries',
               1,
               u'wave:pde2:Neumann',
               u'wave:pde2:Neumann'),
              (u'Neumann boundary condition',
               2,
               u'wave:pde2:Neumann:bc',
               u'wave:pde2:Neumann:bc'),
              (u'Discretization of derivatives at the boundary',
               2,
               u'wave:pde2:Neumann:discr',
               u'wave:pde2:Neumann:discr'),
              (u'Implementation of Neumann conditions',
               2,
               u'wave:pde2:Neumann:impl',
               u'wave:pde2:Neumann:impl'),
              (u'Index set notation', 2, u'wave:indexset', u'wave:indexset'),
              (u'Verifying the implementation of Neumann conditions',
               2,
               u'wave:pde1:verify',
               u'wave:pde1:verify'),
              (u'Alternative implementation via ghost cells',
               2,
               u'wave:pde1:Neumann:ghost',
               u'wave:pde1:Neumann:ghost'),
              (u'Idea', 3, None, '___sec211'),
              (u'Implementation', 3, None, '___sec212'),
              (u'Generalization: variable wave velocity',
               1,
               u'wave:pde2:var:c',
               u'wave:pde2:var:c'),
              (u'The model PDE with a variable coefficient',
               2,
               None,
               '___sec214'),
              (u'Discretizing the variable coefficient',
               2,
               u'wave:pde2:var:c:ideas',
               u'wave:pde2:var:c:ideas'),
              (u'Computing the coefficient between mesh points',
               2,
               u'wave:pde2:var:c:means',
               u'wave:pde2:var:c:means'),
              (u'How a variable coefficient affects the stability',
               2,
               u'wave:pde2:var:c:stability',
               u'wave:pde2:var:c:stability'),
              (u'Neumann condition and a variable coefficient',
               2,
               u'wave:pde2:var:c:Neumann',
               u'wave:pde2:var:c:Neumann'),
              (u'Implementation of variable coefficients',
               2,
               u'wave:pde2:var:c:impl',
               u'wave:pde2:var:c:impl'),
              (u'A more general PDE model with variable coefficients',
               2,
               None,
               '___sec220'),
              (u'Generalization: damping', 2, None, '___sec221'),
              (u'Building a general 1D wave equation solver',
               1,
               u'wave:pde2:software',
               u'wave:pde2:software'),
              (u'User action function as a class', 2, None, '___sec223'),
              (u'The code', 3, None, '___sec224'),
              (u'Dissection', 3, None, '___sec225'),
              (u'Pulse propagation in two media', 2, None, '___sec226'),
              (u'Exercises', 1, None, '___sec227'),
              (u'Exercise 2.7: Find the analytical solution to a damped wave equation',
               2,
               u'wave:exer:standingwave:damped:uex',
               u'wave:exer:standingwave:damped:uex'),
              (u'Problem 2.8: Explore symmetry boundary conditions',
               2,
               u'wave:exer:symmetry:bc',
               u'wave:exer:symmetry:bc'),
              (u'Exercise 2.9: Send pulse waves through a layered medium',
               2,
               u'wave:app:exer:pulse1D',
               u'wave:app:exer:pulse1D'),
              (u'Exercise 2.10: Explain why numerical noise occurs',
               2,
               u'wave:app:exer:pulse1D:analysis',
               u'wave:app:exer:pulse1D:analysis'),
              (u'Exercise 2.11: Investigate harmonic averaging in a 1D model',
               2,
               u'wave:app:exer:pulse1D:harmonic',
               u'wave:app:exer:pulse1D:harmonic'),
              (u'Problem 2.12: Implement open boundary conditions',
               2,
               u'wave:app:exer:radiationBC',
               u'wave:app:exer:radiationBC'),
              (u'Remarks', 3, None, '___sec234'),
              (u'Exercise 2.13: Implement periodic boundary conditions',
               2,
               u'wave:exer:periodic',
               u'wave:exer:periodic'),
              (u'Exercise 2.14: Compare discretizations of a Neumann condition',
               2,
               None,
               '___sec236'),
              (u'Exercise 2.15: Verification by a cubic polynomial in space',
               2,
               u'wave:fd2:exer:verify:cubic',
               u'wave:fd2:exer:verify:cubic'),
              (u'Analysis of the difference equations',
               1,
               u'wave:pde1:analysis',
               u'wave:pde1:analysis'),
              (u'Properties of the solution of the wave equation',
               2,
               u'wave:pde1:properties',
               u'wave:pde1:properties'),
              (u'More precise definition of Fourier representations',
               2,
               u'wave:pde1:Fourier',
               u'wave:pde1:Fourier'),
              (u'Stability',
               2,
               u'wave:pde1:stability',
               u'wave:pde1:stability'),
              (u'Preliminary results', 3, None, '___sec242'),
              (u'Numerical wave propagation', 3, None, '___sec243'),
              (u'Numerical dispersion relation',
               2,
               u'wave:pde1:num:dispersion',
               u'wave:pde1:num:dispersion'),
              (u'Extending the analysis to 2D and 3D',
               2,
               u'wave:pde1:analysis:2D3D',
               u'wave:pde1:analysis:2D3D'),
              (u'Finite difference methods for 2D and 3D wave equations',
               1,
               u'wave:2D3D',
               u'wave:2D3D'),
              (u'Multi-dimensional wave equations',
               2,
               u'wave:2D3D:models',
               u'wave:2D3D:models'),
              (u'Mesh', 2, u'wave:2D3D:mesh', u'wave:2D3D:mesh'),
              (u'Discretization',
               2,
               u'wave:2D3D:discretization',
               u'wave:2D3D:discretization'),
              (u'Discretizing the PDEs', 3, None, '___sec250'),
              (u'Handling boundary conditions where $u$ is known',
               3,
               None,
               '___sec251'),
              (u'Discretizing the Neumann condition', 3, None, '___sec252'),
              (u'Implementation', 1, u'wave:2D3D:impl', u'wave:2D3D:impl'),
              (u'Scalar computations',
               2,
               u'wave2D3D:impl:scalar',
               u'wave2D3D:impl:scalar'),
              (u'Domain and mesh', 3, None, '___sec255'),
              (u'Solution arrays', 3, None, '___sec256'),
              (u'Index sets', 3, None, '___sec257'),
              (u'Computing the solution', 3, None, '___sec258'),
              (u'Vectorized computations',
               2,
               u'wave2D3D:impl:vectorized',
               u'wave2D3D:impl:vectorized'),
              (u'Verification',
               2,
               u'wave2D3D:impl:verify',
               u'wave2D3D:impl:verify'),
              (u'Testing a quadratic solution', 3, None, '___sec261'),
              (u'Exercises', 1, None, '___sec262'),
              (u'Exercise 2.16: Check that a solution fulfills the discrete model',
               2,
               u'wave:exer:quadratic:2D',
               u'wave:exer:quadratic:2D'),
              (u'Project 2.17: Calculus with 2D mesh functions',
               2,
               u'wave:exer:mesh3D:calculus',
               u'wave:exer:mesh3D:calculus'),
              (u'Exercise 2.18: Implement Neumann conditions in 2D',
               2,
               u'wave:app:exer:wave2D:Neumann',
               u'wave:app:exer:wave2D:Neumann'),
              (u'Exercise 2.19: Test the efficiency of compiled loops in 3D',
               2,
               u'wave:exer:3D:f77:cy:efficiency',
               u'wave:exer:3D:f77:cy:efficiency'),
              (u'Applications of wave equations',
               1,
               u'wave:app',
               u'wave:app'),
              (u'Waves on a string',
               2,
               u'wave:app:string',
               u'wave:app:string'),
              (u'Damping', 3, None, '___sec269'),
              (u'External forcing', 3, None, '___sec270'),
              (u'Modeling the tension via springs', 3, None, '___sec271'),
              (u'Elastic waves in a rod',
               2,
               u'wave:app:elastic:rod',
               u'wave:app:elastic:rod'),
              (u'Waves on a membrane',
               2,
               u'wave:app:membrane',
               u'wave:app:membrane'),
              (u'The acoustic model for seismic waves',
               2,
               u'wave:app:acoustic:seismic',
               u'wave:app:acoustic:seismic'),
              (u'Anisotropy', 3, None, '___sec275'),
              (u'Sound waves in liquids and gases',
               2,
               u'wave:app:sound',
               u'wave:app:sound'),
              (u'Spherical waves',
               2,
               u'wave:app:spherical',
               u'wave:app:spherical'),
              (u'The linear shallow water equations',
               2,
               u'wave:app:sw:2D',
               u'wave:app:sw:2D'),
              (u'Wind drag on the surface', 3, None, '___sec279'),
              (u'Bottom drag', 3, None, '___sec280'),
              (u"Effect of the Earth's rotation", 3, None, '___sec281'),
              (u'Waves in blood vessels',
               2,
               u'wave:app:blood',
               u'wave:app:blood'),
              (u'Electromagnetic waves',
               2,
               u'wave:app:light',
               u'wave:app:light'),
              (u'Exercises', 1, u'wave:app:exer', u'wave:app:exer'),
              (u'Exercise 2.20: Simulate waves on a non-homogeneous string',
               2,
               u'wave:app:exer:string:discont',
               u'wave:app:exer:string:discont'),
              (u'Exercise 2.21: Simulate damped waves on a string',
               2,
               u'wave:app:exer:string:damping',
               u'wave:app:exer:string:damping'),
              (u'Exercise 2.22: Simulate elastic waves in a rod',
               2,
               u'wave:app:exer:rod',
               u'wave:app:exer:rod'),
              (u'Exercise 2.23: Simulate spherical waves',
               2,
               u'wave:app:exer:spherical',
               u'wave:app:exer:spherical'),
              (u'Problem 2.24: Earthquake-generated tsunami over a subsea hill',
               2,
               u'wave:app:exer:tsunami1D:hill',
               u'wave:app:exer:tsunami1D:hill'),
              (u'Problem 2.25: Earthquake-generated tsunami over a 3D hill',
               2,
               u'wave:app:exer:tsunami2D:hill',
               u'wave:app:exer:tsunami2D:hill'),
              (u'Problem 2.26: Investigate Matplotlib for visualization',
               2,
               u'wave:app:exer:tsunami:hill:viz:matplotlib',
               u'wave:app:exer:tsunami:hill:viz:matplotlib'),
              (u'Problem 2.27: Investigate visualization packages',
               2,
               u'wave:app:exer:tsunami:hill:viz:packages',
               u'wave:app:exer:tsunami:hill:viz:packages'),
              (u'Problem 2.28: Implement loops in compiled languages',
               2,
               u'wave:app:exer:tsunami2D:hill:compiled',
               u'wave:app:exer:tsunami2D:hill:compiled'),
              (u'Exercise 2.29: Simulate seismic waves in 2D',
               2,
               u'wave:app:exer:seismic2D',
               u'wave:app:exer:seismic2D'),
              (u'Project 2.30: Model 3D acoustic waves in a room',
               2,
               u'wave:app:exer:acoustics',
               u'wave:app:exer:acoustics'),
              (u'Project 2.31: Solve a 1D transport equation',
               2,
               u'wave:app:exer:advec1D',
               u'wave:app:exer:advec1D'),
              (u'Problem 2.32: General analytical solution of a 1D damped wave equation',
               2,
               u'wave:app:exer:anal:damped:wave1D',
               u'wave:app:exer:anal:damped:wave1D'),
              (u'Problem 2.33: General analytical solution of a 2D damped wave equation',
               2,
               u'wave:app:exer:anal:damped:wave2D',
               u'wave:app:exer:anal:damped:wave2D'),
              (u'Diffusion equations', 0, u'ch:diffu', u'ch:diffu'),
              (u'An explicit method for the 1D diffusion equation',
               1,
               u'diffu:pde1:FEsec',
               u'diffu:pde1:FEsec'),
              (u'The initial-boundary value problem for 1D diffusion',
               2,
               None,
               '___sec301'),
              (u'Forward Euler scheme',
               2,
               u'diffu:pde1:FE',
               u'diffu:pde1:FE'),
              (u'Implementation',
               2,
               u'diffu:pde1:FE:code',
               u'diffu:pde1:FE:code'),
              (u'Verification',
               2,
               u'diffu:pde1:FE:verify',
               u'diffu:pde1:FE:verify'),
              (u'Exact solution of discrete equations',
               3,
               u'diffu:pde1:FE:verify:exact',
               u'diffu:pde1:FE:verify:exact'),
              (u'Checking convergence rates',
               3,
               u'diffu:pde1:FE:verify:convrates',
               u'diffu:pde1:FE:verify:convrates'),
              (u'Numerical experiments',
               2,
               u'diffu:pde1:FE:experiments',
               u'diffu:pde1:FE:experiments'),
              (u'Implicit methods for the 1D diffusion equation',
               1,
               u'diffu:pde1:implicit',
               u'diffu:pde1:implicit'),
              (u'Backward Euler scheme',
               2,
               u'diffu:pde1:BE',
               u'diffu:pde1:BE'),
              (u'Sparse matrix implementation',
               2,
               u'diffu:pde1:impl:sparse',
               u'diffu:pde1:impl:sparse'),
              (u'Crank-Nicolson scheme',
               2,
               u'diffu:pde1:CN',
               u'diffu:pde1:CN'),
              (u'The unifying $\\theta$ rule',
               2,
               u'diffu:pde1:theta',
               u'diffu:pde1:theta'),
              (u'Experiments',
               2,
               u'diffu:pde1:theta:experiments',
               u'diffu:pde1:theta:experiments'),
              (u'The Laplace and Poisson equation', 2, None, '___sec314'),
              (u'Analysis of schemes for the diffusion equation',
               1,
               u'diffu:pde1:analysis',
               u'diffu:pde1:analysis'),
              (u'Properties of the solution',
               2,
               u'diffu:pde1:analysis:uex',
               u'diffu:pde1:analysis:uex'),
              (u'Similarity solution', 3, None, '___sec317'),
              (u'Solution for a Gaussian pulse', 3, None, '___sec318'),
              (u'Solution for a sine component', 3, None, '___sec319'),
              (u'Analysis of discrete equations', 2, None, '___sec320'),
              (u'Analysis of the finite difference schemes',
               2,
               u'diffu:pde1:analysis:details',
               u'diffu:pde1:analysis:details'),
              (u'Stability', 3, None, '___sec322'),
              (u'Accuracy', 3, None, '___sec323'),
              (u'Truncation error', 3, None, '___sec324'),
              (u'Analysis of the Forward Euler scheme',
               2,
               u'diffu:pde1:analysis:FE',
               u'diffu:pde1:analysis:FE'),
              (u'Stability', 3, None, '___sec326'),
              (u'Accuracy', 3, None, '___sec327'),
              (u'Truncation error', 3, None, '___sec328'),
              (u'Analysis of the Backward Euler scheme',
               2,
               u'diffu:pde1:analysis:BE',
               u'diffu:pde1:analysis:BE'),
              (u'Stability', 3, None, '___sec330'),
              (u'Truncation error', 3, None, '___sec331'),
              (u'Analysis of the Crank-Nicolson scheme',
               2,
               u'diffu:pde1:analysis:CN',
               u'diffu:pde1:analysis:CN'),
              (u'Stability', 3, None, '___sec333'),
              (u'Truncation error', 3, None, '___sec334'),
              (u'Analysis of the Leapfrog scheme',
               2,
               u'diffu:pde1:analysis:leapfrog',
               u'diffu:pde1:analysis:leapfrog'),
              (u'Summary of accuracy of amplification factors',
               2,
               None,
               '___sec336'),
              (u'Analysis of the 2D diffusion equation',
               2,
               u'diffu:2D:analysis',
               u'diffu:2D:analysis'),
              (u'The Forward Euler scheme', 3, None, '___sec338'),
              (u'The Backward Euler scheme', 3, None, '___sec339'),
              (u'The Crank-Nicolson scheme', 3, None, '___sec340'),
              (u'Explanation of numerical artifacts', 2, None, '___sec341'),
              (u'Exercises', 1, None, '___sec342'),
              (u'Exercise 3.1: Explore symmetry in a 1D problem',
               2,
               u'diffu:exer:1D:gaussian:symmetric',
               u'diffu:exer:1D:gaussian:symmetric'),
              (u'Exercise 3.2: Investigate approximation errors from a $u_x=0$ boundary condition',
               2,
               u'diffu:exer:1D:ux:onesided',
               u'diffu:exer:1D:ux:onesided'),
              (u'Exercise 3.3: Experiment with open boundary conditions in 1D',
               2,
               u'diffu:exer:1D:openBC',
               u'diffu:exer:1D:openBC'),
              (u'Exercise 3.4: Simulate a diffused Gaussian peak in 2D/3D',
               2,
               None,
               '___sec346'),
              (u'Exercise 3.5: Examine stability of a diffusion model with a source term',
               2,
               u'diffu:exer:uterm',
               u'diffu:exer:uterm'),
              (u'Diffusion in heterogeneous media',
               1,
               u'diffu:varcoeff',
               u'diffu:varcoeff'),
              (u'Discretization',
               2,
               u'diffu:varcoeff:discr',
               u'diffu:varcoeff:discr'),
              (u'Implementation',
               2,
               u'diffu:varcoeff:impl',
               u'diffu:varcoeff:impl'),
              (u'Stationary solution',
               2,
               u'diffu:varcoeff:stationary',
               u'diffu:varcoeff:stationary'),
              (u'Piecewise constant medium',
               2,
               u'diffu:varcoeff:piecewise',
               u'diffu:varcoeff:piecewise'),
              (u'Implementation of diffusion in a piecewise constant medium',
               2,
               u'diffu:varcoeff:impl:piecewise',
               u'diffu:varcoeff:impl:piecewise'),
              (u'Axi-symmetric diffusion',
               2,
               u'diffu:fd2:radial',
               u'diffu:fd2:radial'),
              (u'Spherically-symmetric diffusion',
               2,
               u'diffu:fd2:spherical',
               u'diffu:fd2:spherical'),
              (u'Discretization in spherical coordinates',
               3,
               None,
               '___sec356'),
              (u'Discretization in Cartesian coordinates',
               3,
               None,
               '___sec357'),
              (u'Diffusion in 2D', 1, u'diffu:2D', u'diffu:2D'),
              (u'Discretization', 2, u'diffu:2D:discr', u'diffu:2D:discr'),
              (u'Numbering of mesh points versus equations and unknowns',
               2,
               u'diffu:2D:numbering',
               u'diffu:2D:numbering'),
              (u'Algorithm for setting up the coefficient matrix',
               2,
               u'diffu:2D:alg',
               u'diffu:2D:alg'),
              (u'Implementation with a dense coefficient matrix',
               2,
               u'diffu:2D:impl:dense',
               u'diffu:2D:impl:dense'),
              (u'Verification: exact numerical solution',
               2,
               u'diffu:2D:verify',
               u'diffu:2D:verify'),
              (u'Verification: convergence rates',
               2,
               u'diffu:2D:convrate',
               u'diffu:2D:convrate'),
              (u'Implementation with a sparse coefficient matrix',
               2,
               u'diffu:2D:impl:sparse',
               u'diffu:2D:impl:sparse'),
              (u'Understanding the diagonals', 3, None, '___sec366'),
              (u'Filling the diagonals', 3, None, '___sec367'),
              (u'Filling the right-hand side; scalar version',
               3,
               None,
               '___sec368'),
              (u'Filling the right-hand side; vectorized version',
               3,
               None,
               '___sec369'),
              (u'Verification', 3, None, '___sec370'),
              (u'The Jacobi iterative method', 2, None, '___sec371'),
              (u'Numerical scheme and linear system', 3, None, '___sec372'),
              (u'Iterations', 3, None, '___sec373'),
              (u'Initial guess', 3, None, '___sec374'),
              (u'Relaxation', 3, None, '___sec375'),
              (u'Stopping criteria', 3, None, '___sec376'),
              (u'Code-friendly notation', 3, None, '___sec377'),
              (u'Generalization of the scheme', 3, None, '___sec378'),
              (u'Implementation of the Jacobi method',
               2,
               u'diffu:2D:Jacobi:impl',
               u'diffu:2D:Jacobi:impl'),
              (u'Test problem: diffusion of a sine hill',
               2,
               u'diffu:2D:Jacobi:impl:hill',
               u'diffu:2D:Jacobi:impl:hill'),
              (u'The relaxed Jacobi method and its relation to the Forward Euler method',
               2,
               u'diffu:2D:Jacobi_vs_FE',
               u'diffu:2D:Jacobi_vs_FE'),
              (u'The Gauss-Seidel and SOR methods',
               2,
               u'diffu:2D:SOR',
               u'diffu:2D:SOR'),
              (u'Scalar implementation of the SOR method',
               2,
               u'diffu:2D:SOR:impl:scalar',
               u'diffu:2D:SOR:impl:scalar'),
              (u'Vectorized implementation of the SOR method',
               2,
               u'diffu:2D:SOR:impl:vectorized',
               u'diffu:2D:SOR:impl:vectorized'),
              (u'Direct versus iterative methods',
               2,
               u'diffu:2D:direct_vs_iter',
               u'diffu:2D:direct_vs_iter'),
              (u'Direct methods', 3, None, '___sec386'),
              (u'Iterative methods', 3, None, '___sec387'),
              (u'The Conjugate gradient method',
               2,
               u'diffu:2D:CG',
               u'diffu:2D:CG'),
              (u'What is the recommended method for solving linear systems?',
               2,
               None,
               '___sec389'),
              (u'Random walk', 1, u'diffu:randomwalk', u'diffu:randomwalk'),
              (u'Random walk in 1D',
               2,
               u'diffu:randomwalk:1D',
               u'diffu:randomwalk:1D'),
              (u'Statistical considerations',
               2,
               u'diffu:randomwalk:1D:EVar',
               u'diffu:randomwalk:1D:EVar'),
              (u'Playing around with some code',
               2,
               u'diffu:randomwalk:1D:code1',
               u'diffu:randomwalk:1D:code1'),
              (u'Scalar code', 3, None, '___sec394'),
              (u'Vectorized code', 3, None, '___sec395'),
              (u'Fixing the random sequence', 3, None, '___sec396'),
              (u'Verification', 3, None, '___sec397'),
              (u'Equivalence with diffusion',
               2,
               u'diffu:randomwalk:1D:pde',
               u'diffu:randomwalk:1D:pde'),
              (u'Implementation of multiple walks', 2, None, '___sec399'),
              (u'Scalar version', 3, None, '___sec400'),
              (u'Vectorized version', 3, None, '___sec401'),
              (u'Improved vectorized version', 3, None, '___sec402'),
              (u'Remark on vectorized code and parallelization',
               3,
               None,
               '___sec403'),
              (u'Test function', 3, None, '___sec404'),
              (u'Demonstration of multiple walks', 2, None, '___sec405'),
              (u'Ascii visualization of 1D random walk',
               2,
               u'diffu:randomwalk:1D:avplotter',
               u'diffu:randomwalk:1D:avplotter'),
              (u'Random walk as a stochastic equation',
               2,
               u'diffu:randomwalk:1D:ode',
               u'diffu:randomwalk:1D:ode'),
              (u'Random walk in 2D', 2, None, '___sec408'),
              (u'Random walk in any number of space dimensions',
               2,
               None,
               '___sec409'),
              (u'Multiple random walks in any number of space dimensions',
               2,
               None,
               '___sec410'),
              (u'Scalar code', 3, None, '___sec411'),
              (u'Vectorized code', 3, None, '___sec412'),
              (u'Applications', 1, u'diffu:app', u'diffu:app'),
              (u'Diffusion of a substance',
               2,
               u'diffu:app:substance',
               u'diffu:app:substance'),
              (u'Heat conduction', 2, u'diffu:app:heat', u'diffu:app:heat'),
              (u'Porous media flow',
               2,
               u'diffu:app:porous',
               u'diffu:app:porous'),
              (u'Potential fluid flow', 2, None, '___sec417'),
              (u'Streamlines for 2D fluid flow', 2, None, '___sec418'),
              (u'The potential of an electric field', 2, None, '___sec419'),
              (u'Development of flow between two flat plates',
               2,
               u'diffu:app:Couette',
               u'diffu:app:Couette'),
              (u'Flow in a straight tube',
               2,
               u'diffu:app:pipeflow',
               u'diffu:app:pipeflow'),
              (u'Tribology: thin film fluid flow', 2, None, '___sec422'),
              (u'Propagation of electrical signals in the brain',
               2,
               None,
               '___sec423'),
              (u'Exercises', 1, None, '___sec424'),
              (u'Exercise 3.6: Stabilizing the Crank-Nicolson method by Rannacher time stepping',
               2,
               u'diffu:exer:CN:Rannacher',
               u'diffu:exer:CN:Rannacher'),
              (u'Project 3.7: Energy estimates for diffusion problems',
               2,
               u'diffu:exer:energy:estimates',
               u'diffu:exer:energy:estimates'),
              (u'Exercise 3.8: Splitting methods and preconditioning',
               2,
               u'diffu:exer:splitting_prec',
               u'diffu:exer:splitting_prec'),
              (u'Problem 3.9: Oscillating surface temperature of the earth',
               2,
               u'diffu:exer:earthosc',
               u'diffu:exer:earthosc'),
              (u'Problem 3.10: Oscillating and pulsating flow in tubes',
               2,
               u'diffu:exer:bloodflow',
               u'diffu:exer:bloodflow'),
              (u'Problem 3.11: Scaling a welding problem',
               2,
               u'diffu:exer:welding',
               u'diffu:exer:welding'),
              (u'Exercise 3.12: Implement a Forward Euler scheme for axi-symmetric diffusion',
               2,
               u'diffu:exer:axisymm',
               u'diffu:exer:axisymm'),
              (u'Advection-dominated equations',
               0,
               u'ch:convdiff',
               u'ch:convdiff'),
              (u'One-dimensional time-dependent advection equations',
               1,
               u'advec:1D',
               u'advec:1D'),
              (u'Simplest scheme: forward in time, centered in space',
               2,
               u'advec:1D:FTCS',
               u'advec:1D:FTCS'),
              (u'Method', 3, None, '___sec435'),
              (u'Implementation', 3, None, '___sec436'),
              (u'Test cases', 3, None, '___sec437'),
              (u'Bug?', 3, None, '___sec438'),
              (u'Analysis of the scheme',
               2,
               u'advec:1D:FTCS:anal',
               u'advec:1D:FTCS:anal'),
              (u'Leapfrog in time, centered differences in space',
               2,
               u'advec:1D:leapfrog',
               u'advec:1D:leapfrog'),
              (u'Method', 3, None, '___sec441'),
              (u'Implementation', 3, None, '___sec442'),
              (u'Running a test case', 3, None, '___sec443'),
              (u'Analysis', 3, None, '___sec444'),
              (u'Upwind differences in space',
               2,
               u'advec:1D:FTUP',
               u'advec:1D:FTUP'),
              (u'Periodic boundary conditions',
               2,
               u'advec:1D:periodic_BC',
               u'advec:1D:periodic_BC'),
              (u'A Crank-Nicolson discretization in time and centered differences in space',
               2,
               u'advec:1D:CN',
               u'advec:1D:CN'),
              (u'The Lax-Wendroff method',
               2,
               u'advec:1D:LaxW',
               u'advec:1D:LaxW'),
              (u'Analysis of dispersion relations',
               2,
               u'advec:1D:disprel',
               u'advec:1D:disprel'),
              (u'One-dimensional stationary advection-diffusion equation',
               1,
               u'advec:1D:stationary',
               u'advec:1D:stationary'),
              (u'Two-dimensional advection-diffusion equations',
               1,
               u'advec:2D',
               u'advec:2D'),
              (u'Applications of advection equations',
               1,
               u'advec:app',
               u'advec:app'),
              (u'Nonlinear problems', 0, u'ch:nonlin', u'ch:nonlin'),
              (u'Introduction of basic concepts',
               1,
               u'nonlin:timediscrete:logistic',
               u'nonlin:timediscrete:logistic'),
              (u'Linear versus nonlinear equations', 2, None, '___sec455'),
              (u'Algebraic equations', 3, None, '___sec456'),
              (u'Differential equations', 3, None, '___sec457'),
              (u'A simple model problem', 2, None, '___sec458'),
              (u'Linearization by explicit time discretization',
               2,
               u'nonlin:timediscrete:logistic:FE',
               u'nonlin:timediscrete:logistic:FE'),
              (u'Exact solution of nonlinear algebraic equations',
               2,
               u'nonlin:timediscrete:logistic:roots',
               u'nonlin:timediscrete:logistic:roots'),
              (u'Linearization', 2, None, '___sec461'),
              (u'Picard iteration',
               2,
               u'nonlin:timediscrete:logistic:Picard',
               u'nonlin:timediscrete:logistic:Picard'),
              (u'Stopping criteria', 3, None, '___sec463'),
              (u'A single Picard iteration', 3, None, '___sec464'),
              (u'Linearization by a geometric mean',
               2,
               u'nonlin:timediscrete:logistic:geometric:mean',
               u'nonlin:timediscrete:logistic:geometric:mean'),
              (u"Newton's method",
               2,
               u'nonlin:timediscrete:logistic:Newton',
               u'nonlin:timediscrete:logistic:Newton'),
              (u'Relaxation',
               2,
               u'nonlin:timediscrete:logistic:relaxation',
               u'nonlin:timediscrete:logistic:relaxation'),
              (u'Implementation and experiments',
               2,
               u'nonlin:timediscrete:logistic:impl',
               u'nonlin:timediscrete:logistic:impl'),
              (u'Generalization to a general nonlinear ODE',
               2,
               u'nonlin:ode:generic',
               u'nonlin:ode:generic'),
              (u'Explicit time discretization', 3, None, '___sec470'),
              (u'Backward Euler discretization', 3, None, '___sec471'),
              (u'Crank-Nicolson discretization', 3, None, '___sec472'),
              (u'Systems of ODEs',
               2,
               u'nonlin:ode:generic:sys:pendulum',
               u'nonlin:ode:generic:sys:pendulum'),
              (u'Example', 3, None, '___sec474'),
              (u'Systems of nonlinear algebraic equations',
               1,
               u'nonlin:systems:alg',
               u'nonlin:systems:alg'),
              (u'Picard iteration',
               2,
               u'nonlin:systems:alg:Picard',
               u'nonlin:systems:alg:Picard'),
              (u"Newton's method",
               2,
               u'nonlin:systems:alg:Newton',
               u'nonlin:systems:alg:Newton'),
              (u'Stopping criteria',
               2,
               u'nonlin:systems:alg:terminate',
               u'nonlin:systems:alg:terminate'),
              (u'Example: A nonlinear ODE model from epidemiology',
               2,
               u'nonlin:systems:alg:SI',
               u'nonlin:systems:alg:SI'),
              (u'Implicit time discretization', 3, None, '___sec480'),
              (u'A Picard iteration', 3, None, '___sec481'),
              (u"Newton's method", 3, None, '___sec482'),
              (u'Linearization at the differential equation level',
               1,
               u'nonlin:pdelevel',
               u'nonlin:pdelevel'),
              (u'Explicit time integration',
               2,
               u'nonlin:pdelevel:explicit',
               u'nonlin:pdelevel:explicit'),
              (u'Backward Euler scheme and Picard iteration',
               2,
               u'nonlin:pdelevel:Picard',
               u'nonlin:pdelevel:Picard'),
              (u"Backward Euler scheme and Newton's method",
               2,
               u'nonlin:pdelevel:Newton',
               u'nonlin:pdelevel:Newton'),
              (u'Linearization via Taylor expansions', 3, None, '___sec487'),
              (u'Similarity with Picard iteration', 3, None, '___sec488'),
              (u'Implementation', 3, None, '___sec489'),
              (u'Derivation with alternative notation', 3, None, '___sec490'),
              (u'Crank-Nicolson discretization',
               2,
               u'nonlin:pdelevel:Picard:CN',
               u'nonlin:pdelevel:Picard:CN'),
              (u'1D stationary nonlinear differential equations',
               1,
               u'nonlin:alglevel:1D',
               u'nonlin:alglevel:1D'),
              (u'Finite difference discretization',
               2,
               u'nonlin:alglevel:1D:fd',
               u'nonlin:alglevel:1D:fd'),
              (u'Solution of algebraic equations', 2, None, '___sec494'),
              (u'The structure of the equation system', 3, None, '___sec495'),
              (u'Picard iteration', 3, None, '___sec496'),
              (u'Mesh with two cells', 3, None, '___sec497'),
              (u"Newton's method", 3, None, '___sec498'),
              (u'Multi-dimensional nonlinear PDE problems',
               1,
               None,
               '___sec499'),
              (u'Finite difference discretization',
               2,
               u'nonlin:alglevel:dD:fd',
               u'nonlin:alglevel:dD:fd'),
              (u'Picard iteration', 3, None, '___sec501'),
              (u"Newton's method", 3, None, '___sec502'),
              (u'Continuation methods', 2, None, '___sec503'),
              (u'Operator splitting methods',
               1,
               u'nonlin:splitting',
               u'nonlin:splitting'),
              (u'Ordinary operator splitting for ODEs',
               2,
               u'nonlin:splitting:ODE',
               u'nonlin:splitting:ODE'),
              (u'Strang splitting for ODEs',
               2,
               u'nonlin:splitting:ODE_Strang',
               u'nonlin:splitting:ODE_Strang'),
              (u'Example: Logistic growth',
               2,
               u'nonlin:splitting:logistic',
               u'nonlin:splitting:logistic'),
              (u'Splitting techniques', 3, None, '___sec508'),
              (u'Verbose implementation', 3, None, '___sec509'),
              (u'Compact implementation', 3, None, '___sec510'),
              (u'Results', 3, None, '___sec511'),
              (u'Reaction-diffusion equation',
               2,
               u'nonlin:splitting:RD',
               u'nonlin:splitting:RD'),
              (u'Example: Reaction-Diffusion with linear reaction term',
               2,
               u'nonlin:splitting:RD_linearR',
               u'nonlin:splitting:RD_linearR'),
              (u'Analysis of the splitting method', 2, None, '___sec514'),
              (u'Exercises', 1, u'nonlin:exer', u'nonlin:exer'),
              (u'Problem 5.1: Determine if equations are nonlinear or not',
               2,
               u'nonlin:exer:lin:vs:nonlin',
               u'nonlin:exer:lin:vs:nonlin'),
              (u'Problem 5.2: Derive and investigate a generalized logistic model',
               2,
               u'nonlin:exer:logistic:gen',
               u'nonlin:exer:logistic:gen'),
              (u"Problem 5.3: Experience the behavior of Newton's method",
               2,
               u'nonlin:exer:Newton:problems1',
               u'nonlin:exer:Newton:problems1'),
              (u'Exercise 5.4: Compute the Jacobian of a $2\\times 2$ system',
               2,
               u'nonlin:exer:vib:Jacobian',
               u'nonlin:exer:vib:Jacobian'),
              (u'Problem 5.5: Solve nonlinear equations arising from a vibration ODE',
               2,
               u'nonlin:exer:vib:geometric:mean',
               u'nonlin:exer:vib:geometric:mean'),
              (u'Exercise 5.6: Find the truncation error of arithmetic mean of products',
               2,
               u'nonlin:exer:products:arith:mean',
               u'nonlin:exer:products:arith:mean'),
              (u"Problem 5.7: Newton's method for linear problems",
               2,
               u'nonlin:exer:Newton:linear',
               u'nonlin:exer:Newton:linear'),
              (u'Problem 5.8: Discretize a 1D problem with a nonlinear coefficient',
               2,
               u'nonlin:exer:1D:1pu2:fem',
               u'nonlin:exer:1D:1pu2:fem'),
              (u'Problem 5.9: Linearize a 1D problem with a nonlinear coefficient',
               2,
               u'nonlin:exer:1D:1pu2:PicardNewton',
               u'nonlin:exer:1D:1pu2:PicardNewton'),
              (u'Problem 5.10: Finite differences for the 1D Bratu problem',
               2,
               u'nonlin:exer:1D:fu:discretize:fd',
               u'nonlin:exer:1D:fu:discretize:fd'),
              (u'Problem 5.11: Discretize a nonlinear 1D heat conduction PDE by finite differences',
               2,
               u'nonlin:exer:1D:heat:nonlinear:fdm',
               u'nonlin:exer:1D:heat:nonlinear:fdm'),
              (u'Problem 5.12: Differentiate a highly nonlinear term',
               2,
               u'nonlin:exer:grad:pow:term',
               u'nonlin:exer:grad:pow:term'),
              (u'Exercise 5.13: Crank-Nicolson for a nonlinear 3D diffusion equation',
               2,
               u'nonlin:exer:2D:heat:nonlinear:fd',
               u'nonlin:exer:2D:heat:nonlinear:fd'),
              (u'Problem 5.14: Find the sparsity of the Jacobian',
               2,
               u'nonlin:exer:sparsity:Jacobian',
               u'nonlin:exer:sparsity:Jacobian'),
              (u'Problem 5.15: Investigate a 1D problem with a continuation method',
               2,
               u'nonlin:exer:continuation:1DnNflow',
               u'nonlin:exer:continuation:1DnNflow'),
              (u'Appendix: Useful formulas',
               0,
               u'ch:formulas',
               u'ch:formulas'),
              (u'Finite difference operator notation',
               1,
               u'sec:form:fdop',
               u'sec:form:fdop'),
              (u'Truncation errors of finite difference approximations',
               1,
               u'sec:form:truncerr',
               u'sec:form:truncerr'),
              (u'Finite differences of exponential functions',
               1,
               u'sec:form:fdexp',
               u'sec:form:fdexp'),
              (u'Complex exponentials', 3, None, '___sec535'),
              (u'Real exponentials', 3, None, '___sec536'),
              (u'Finite differences of $t^n$',
               1,
               u'sec:form:fdtn',
               u'sec:form:fdtn'),
              (u'Software', 2, None, '___sec538'),
              (u'Appendix: Truncation error analysis',
               0,
               u'ch:trunc',
               u'ch:trunc'),
              (u'Overview of truncation error analysis',
               1,
               None,
               '___sec540'),
              (u'Abstract problem setting', 2, None, '___sec541'),
              (u'Error measures', 2, None, '___sec542'),
              (u'Truncation errors in finite difference formulas',
               1,
               u'trunc:finite:differences',
               u'trunc:finite:differences'),
              (u"Example: The backward difference for $u'(t)$",
               2,
               u'trunc:fd:backward',
               u'trunc:fd:backward'),
              (u"Example: The forward difference for $u'(t)$",
               2,
               u'trunc:fd:forward',
               u'trunc:fd:forward'),
              (u"Example: The central difference for $u'(t)$",
               2,
               u'trunc:fd:central',
               u'trunc:fd:central'),
              (u'Overview of leading-order error terms in finite difference formulas',
               2,
               u'trunc:table',
               u'trunc:table'),
              (u'Software for computing truncation errors',
               2,
               u'trunc:sympy',
               u'trunc:sympy'),
              (u'Exponential decay ODEs', 1, u'trunc:decay', u'trunc:decay'),
              (u'Forward Euler scheme',
               2,
               u'trunc:decay:FE',
               u'trunc:decay:FE'),
              (u'Crank-Nicolson scheme',
               2,
               u'trunc:decay:CN',
               u'trunc:decay:CN'),
              (u'The $\\theta$-rule',
               2,
               u'trunc:decay:theta',
               u'trunc:decay:theta'),
              (u'Using symbolic software',
               2,
               u'trunc:decay:software',
               u'trunc:decay:software'),
              (u'Empirical verification of the truncation error',
               2,
               u'trunc:decay:estimate:R',
               u'trunc:decay:estimate:R'),
              (u'Increasing the accuracy by adding correction terms',
               2,
               u'trunc:decay:corr',
               u'trunc:decay:corr'),
              (u'Extension to variable coefficients', 2, None, '___sec556'),
              (u'Exact solutions of the finite difference equations',
               2,
               None,
               '___sec557'),
              (u'Computing truncation errors in nonlinear problems',
               2,
               u'trunc:decay:gen',
               u'trunc:decay:gen'),
              (u'Vibration ODEs', 1, u'trunc:vib', u'trunc:vib'),
              (u'Linear model without damping',
               2,
               u'trunc:vib:undamped',
               u'trunc:vib:undamped'),
              (u'The truncation error of a centered finite difference scheme',
               3,
               None,
               '___sec561'),
              (u"The truncation error of approximating $u'(0)$",
               3,
               None,
               '___sec562'),
              (u'Truncation error of the equation for the first step',
               3,
               None,
               '___sec563'),
              (u'Computing correction terms', 3, None, '___sec564'),
              (u'Model with damping and nonlinearity',
               2,
               u'trunc:vib:gen',
               u'trunc:vib:gen'),
              (u'Extension to quadratic damping', 2, None, '___sec566'),
              (u'The general model formulated as first-order ODEs',
               2,
               u'trunc:vib:gen:staggered',
               u'trunc:vib:gen:staggered'),
              (u'A centered scheme on a staggered mesh',
               3,
               None,
               '___sec568'),
              (u'Wave equations', 1, None, '___sec569'),
              (u'Linear wave equation in 1D',
               2,
               u'trunc:wave:1D',
               u'trunc:wave:1D'),
              (u'Finding correction terms',
               2,
               u'trunc:wave:1D:corr',
               u'trunc:wave:1D:corr'),
              (u'Extension to variable coefficients',
               2,
               u'trunc:wave:1D:varcoeff',
               u'trunc:wave:1D:varcoeff'),
              (u'1D wave equation on a staggered mesh', 2, None, '___sec573'),
              (u'Linear wave equation in 2D/3D',
               2,
               u'trunc:wave:2D',
               u'trunc:wave:2D'),
              (u'Diffusion equations', 1, u'trunc:diffu', u'trunc:diffu'),
              (u'Linear diffusion equation in 1D',
               2,
               u'trunc:diffu:1D',
               u'trunc:diffu:1D'),
              (u'The Forward Euler scheme in time', 3, None, '___sec577'),
              (u'The Crank-Nicolson scheme in time', 3, None, '___sec578'),
              (u'Nonlinear diffusion equation in 1D', 2, None, '___sec579'),
              (u'Exercises', 1, None, '___sec580'),
              (u'Exercise B.1: Truncation error of a weighted mean',
               2,
               u'trunc:exer:theta:avg',
               u'trunc:exer:theta:avg'),
              (u'Exercise B.2: Simulate the error of a weighted mean',
               2,
               u'trunc:exer:theta:avg2',
               u'trunc:exer:theta:avg2'),
              (u'Exercise B.3: Verify a truncation error formula',
               2,
               u'trunc:exer:decay:bw2',
               u'trunc:exer:decay:bw2'),
              (u'Problem B.4: Truncation error of the Backward Euler scheme',
               2,
               u'trunc:exer:decay:BE',
               u'trunc:exer:decay:BE'),
              (u'Exercise B.5: Empirical estimation of truncation errors',
               2,
               u'trunc:exer:decay:estimate',
               u'trunc:exer:decay:estimate'),
              (u'Exercise B.6: Correction term for a Backward Euler scheme',
               2,
               u'trunc:exer:decay:corr:BE',
               u'trunc:exer:decay:corr:BE'),
              (u'Problem B.7: Verify the effect of correction terms',
               2,
               u'trunc:exer:decay:corr:verify',
               u'trunc:exer:decay:corr:verify'),
              (u'Problem B.8: Truncation error of the Crank-Nicolson scheme',
               2,
               u'trunc:exer:decay:varcoeff:CN',
               u'trunc:exer:decay:varcoeff:CN'),
              (u"Problem B.9: Truncation error of $u'=f(u,t)$",
               2,
               u'trunc:exer:decay:nonlin:BEFE',
               u'trunc:exer:decay:nonlin:BEFE'),
              (u'Exercise B.10: Truncation error of $[D_t D_tu]^n$',
               2,
               u'trunc:exer:DtDtu',
               u'trunc:exer:DtDtu'),
              (u"Exercise B.11: Investigate the impact of approximating $u'(0)$",
               2,
               u'trunc:exer:vib:ic:fw',
               u'trunc:exer:vib:ic:fw'),
              (u'Problem B.12: Investigate the accuracy of a simplified scheme',
               2,
               u'trunc:exer:vib:fbw',
               u'trunc:exer:vib:fbw'),
              (u'Appendix: Software engineering; wave equation model',
               0,
               u'ch:softeng2',
               u'ch:softeng2'),
              (u'A 1D wave equation simulator', 1, None, '___sec594'),
              (u'Mathematical model', 2, None, '___sec595'),
              (u'Numerical discretization', 2, None, '___sec596'),
              (u'A solver function', 2, None, '___sec597'),
              (u'Saving large arrays in files',
               1,
               u'softeng2:wave1D:filestorage',
               u'softeng2:wave1D:filestorage'),
              (u'Using `savez` to store arrays in files',
               2,
               u'softeng2:wave1D:filestorage:savez',
               u'softeng2:wave1D:filestorage:savez'),
              (u'Storing individual arrays', 3, None, '___sec600'),
              (u'Merging zip archives', 3, None, '___sec601'),
              (u'Reading arrays from zip archives', 3, None, '___sec602'),
              (u'Using `joblib` to store arrays in files',
               2,
               u'softeng2:wave1D:filestorage:joblib',
               u'softeng2:wave1D:filestorage:joblib'),
              (u'Using a hash to create a file or directory name',
               2,
               u'softeng2:wave1D:filestorage:hash',
               u'softeng2:wave1D:filestorage:hash'),
              (u'Software for the 1D wave equation', 1, None, '___sec605'),
              (u'Making hash strings from input data',
               2,
               u'softeng2:wave1D:filestorage:hashlib',
               u'softeng2:wave1D:filestorage:hashlib'),
              (u'Avoiding rerunning previously run cases',
               2,
               u'softeng2:wave1D:filestorage:norerun',
               u'softeng2:wave1D:filestorage:norerun'),
              (u'Verification', 2, None, '___sec608'),
              (u'Vanishing approximation error', 3, None, '___sec609'),
              (u'Convergence rates', 3, None, '___sec610'),
              (u'Programming the solver with classes', 1, None, '___sec611'),
              (u'Class Problem', 2, None, '___sec612'),
              (u'Class Mesh', 2, None, '___sec613'),
              (u'Class Function', 2, None, '___sec614'),
              (u'Class Solver', 2, None, '___sec615'),
              (u'Migrating loops to Cython',
               1,
               u'wave2D3D:impl:Cython',
               u'wave2D3D:impl:Cython'),
              (u'Declaring variables and annotating the code',
               2,
               None,
               '___sec617'),
              (u'Visual inspection of the C translation',
               2,
               None,
               '___sec618'),
              (u'Building the extension module', 2, None, '___sec619'),
              (u'Calling the Cython function from Python',
               2,
               None,
               '___sec620'),
              (u'Efficiency', 3, None, '___sec621'),
              (u'Migrating loops to Fortran', 1, None, '___sec622'),
              (u'The Fortran subroutine', 2, None, '___sec623'),
              (u'Building the Fortran module with f2py',
               2,
               None,
               '___sec624'),
              (u'How to avoid array copying', 2, None, '___sec625'),
              (u'Efficiency', 3, None, '___sec626'),
              (u'Migrating loops to C via Cython', 1, None, '___sec627'),
              (u'Translating index pairs to single indices',
               2,
               None,
               '___sec628'),
              (u'The complete C code', 2, None, '___sec629'),
              (u'The Cython interface file', 2, None, '___sec630'),
              (u'Building the extension module', 2, None, '___sec631'),
              (u'Efficiency', 3, None, '___sec632'),
              (u'Migrating loops to C via f2py', 1, None, '___sec633'),
              (u'Migrating loops to C++ via f2py', 2, None, '___sec634'),
              (u'Exercises', 1, None, '___sec635'),
              (u'Exercise C.1: Explore computational efficiency of numpy.sum versus built-in sum',
               2,
               u'softeng2:exer:sum',
               u'softeng2:exer:sum'),
              (u'Exercise C.2: Make an improved `numpy.savez` function',
               2,
               u'softeng2:exer:savez',
               u'softeng2:exer:savez'),
              (u'Exercise C.3: Visualize the impact of the Courant number',
               2,
               u'softeng2:exer:pulse1D:C',
               u'softeng2:exer:pulse1D:C'),
              (u'Exercise C.4: Visualize the impact of the resolution',
               2,
               u'softeng2:exer:pulse1D:Nx',
               u'softeng2:exer:pulse1D:Nx'),
              (u'References', 1, None, '___sec640')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\uexd}[1]{{u_{\small\mbox{e}, #1}}}
\newcommand{\vex}{{v_{\small\mbox{e}}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\acc}{\boldsymbol{a}}
\newcommand{\rpos}{\boldsymbol{r}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}
\newcommand{\q}{\boldsymbol{q}}
\newcommand{\g}{\boldsymbol{g}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\Iz}{\mathcal{I}_z}
\newcommand{\It}{\mathcal{I}_t}
\newcommand{\setb}[1]{#1^0}    % set begin
\newcommand{\sete}[1]{#1^{-1}} % set end
\newcommand{\setl}[1]{#1^-}
\newcommand{\setr}[1]{#1^+}
\newcommand{\seti}[1]{#1^i}
\newcommand{\stepzero}{*}
\newcommand{\stephalf}{***}
\newcommand{\stepone}{**}
\newcommand{\baspsi}{\psi}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<a name="part0011"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._fdm-book-solarized010.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._fdm-book-solarized012.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1 id="wave:app:exer">Exercises</h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:string:discont">Exercise 2.20: Simulate waves on a non-homogeneous string</h2>

<p>
Simulate waves on a string that consists of two materials with
different density. The tension in the string is constant, but the
density has a jump at the middle of the string.  Experiment with
different sizes of the jump and produce animations that visualize the
effect of the jump on the wave motion.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
According to the section <a href="._fdm-book-solarized010.html#wave:app:string">Waves on a string</a>,
the density enters the mathematical model as \( \varrho \) in
\( \varrho u_{tt} = Tu_{xx} \), where \( T \) is the string tension. Modify, e.g., the
<code>wave1D_u0v.py</code> code to incorporate the tension and two density values.
Make a mesh function <code>rho</code> with density values at each spatial mesh point.
A value for the tension may be 150 N. Corresponding density values can
be computed from the wave velocity estimations in the <code>guitar</code> function
in the <code>wave1D_u0v.py</code> file.

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>wave1D_u0_sv_discont</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:string:damping">Exercise 2.21: Simulate damped waves on a string</h2>

<p>
Formulate a mathematical model for damped waves on a string.
Use data from the section <a href="._fdm-book-solarized006.html#wave:pde1:guitar:data">Running a case</a>, and
tune the damping parameter so that the string is very close to
the rest state after 15 s. Make a movie of the wave motion.
Filename: <code>wave1D_u0_sv_damping</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:rod">Exercise 2.22: Simulate elastic waves in a rod</h2>

<p>
A hammer hits the end of an elastic rod. The exercise is to simulate
the resulting wave motion using the model <a href="._fdm-book-solarized010.html#mjx-eqn-287">(287)</a>
from the section <a href="._fdm-book-solarized010.html#wave:app:elastic:rod">Elastic waves in a rod</a>. Let the rod have length
\( L \) and let the boundary \( x=L \) be stress free so that \( \sigma_{xx}=0 \),
implying that \( \partial u/\partial x=0 \). The left end \( x=0 \) is
subject to a strong stress pulse (the hammer), modeled as

$$ \sigma_{xx}(t) = \left\lbrace\begin{array}{ll}
S,& 0 < t \leq t_s,\\ 
0, & t > t_s
\end{array}\right.
$$

The corresponding condition on \( u \) becomes \( u_x= S/E \)
for \( t\leq t_s \) and zero afterwards (recall that
\( \sigma_{xx} = Eu_x \)). This is a non-homogeneous
Neumann condition, and you will need to approximate this condition
and combine it with the scheme (the ideas and manipulations follow
closely the handling of a non-zero initial condition
\( u_t=V \) in wave PDEs or the corresponding
second-order ODEs for vibrations).
Filename: <code>wave_rod</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:spherical">Exercise 2.23: Simulate spherical waves</h2>

<p>
Implement a model for spherically symmetric waves using the method
described in the section <a href="._fdm-book-solarized010.html#wave:app:spherical">Spherical waves</a>. The boundary condition
at \( r=0 \) must be \( \partial u/\partial r=0 \), while the condition at
\( r=R \) can either be \( u=0 \) or a radiation condition as described
in <a href="._fdm-book-solarized007.html#wave:app:exer:radiationBC">Problem 2.12: Implement open boundary conditions</a>. The \( u=0 \) condition is
sufficient if \( R \) is so large that the amplitude of the spherical
wave has become insignificant. Make movie(s) of the case where the source
term is located around \( r=0 \) and sends out pulses

$$ f(r,t) = \left\lbrace\begin{array}{ll}
Q\exp{(-\frac{r^2}{2\Delta r^2})}\sin\omega t,& \sin\omega t\geq 0\\ 
0, & \sin\omega t < 0
\end{array}\right.
$$

Here, \( Q \) and \( \omega \) are constants to be chosen.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
Use the program <code>wave1D_u0v.py</code> as a starting point. Let <code>solver</code>
compute the \( v \) function and then set \( u=v/r \). However,
\( u=v/r \) for \( r=0 \) requires special treatment. One possibility is
to compute <code>u[1:] = v[1:]/r[1:]</code> and then set <code>u[0]=u[1]</code>. The latter
makes it evident that \( \partial u/\partial r = 0 \) in a plot.

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>wave1D_spherical</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:tsunami1D:hill">Problem 2.24: Earthquake-generated tsunami over a subsea hill</h2>

<p>
A subsea earthquake leads to an immediate lift of the water surface,
see Figure <a href="#wave:app:fig:1D:tsunami:flat">32</a>.  The lifted water
surface splits into two tsunamis, one traveling to the right and one
to the left, as depicted in Figure
<a href="#wave:app:fig:1D:tsunami:2waves">33</a>.  Since tsunamis are normally very
long waves, compared to the depth, with a small amplitude, compared to
the wave length, a standard wave equation is relevant:

$$ \eta_{tt} = (gH(x)\eta_x)_x,$$

where \( \eta \) is the elevation of the water surface,
\( g \) is the acceleration of gravity, and \( H(x) \) is the still water depth.

<p>
<center> <!-- figure label: --> <div id="wave:app:fig:1D:tsunami:flat"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 32:  Sketch of initial water surface due to a subsea earthquake.  <!-- caption label: wave:app:fig:1D:tsunami:flat --> </p></center>
<p><img src="fig-wave/earthquake_tsunami_flat.png" align="bottom" width=800></p>
</center>

<p>
<center> <!-- figure label: --> <div id="wave:app:fig:1D:tsunami:2waves"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 33:  An initial surface elevation is split into two waves.  <!-- caption label: wave:app:fig:1D:tsunami:2waves --> </p></center>
<p><img src="fig-wave/earthquake_tsunami_2waves.png" align="bottom" width=800></p>
</center>

<p>
To simulate the right-going tsunami, we can impose a symmetry boundary
at \( x=0 \): \( \partial\eta/\partial x =0 \).  We then simulate the wave
motion in \( [0,L] \). Unless the ocean ends at \( x=L \), the waves should
travel undisturbed through the boundary \( x=L \). A radiation condition
as explained in <a href="._fdm-book-solarized007.html#wave:app:exer:radiationBC">Problem 2.12: Implement open boundary conditions</a> can be used for
this purpose. Alternatively, one can just stop the simulations before
the wave hits the boundary at \( x=L \). In that case it does not matter
what kind of boundary condition we use at \( x=L \). Imposing \( \eta =0 \)
and stopping the simulations when \( |\eta_i^n| > \epsilon \), \( i=N_x-1 \),
is a possibility (\( \epsilon \) is a small parameter).

<p>
The shape of the initial surface can be taken as a
Gaussian function,

$$
\begin{equation}
I(x;I_0,I_a,I_m,I_s) =
I_0 + I_a\exp{\left(-\left(\frac{x-I_m}{I_s}\right)^2\right)},
\tag{329}
\end{equation}
$$

with \( I_m=0 \) reflecting the location of the peak of \( I(x) \) and
\( I_s \) being a measure of the width of the function \( I(x) \)
(\( I_s \) is \( \sqrt{2} \) times the standard deviation of the familiar
normal distribution curve).

<p>
Now we extend the problem with a hill at the sea bottom, see Figure
<a href="#wave:app:fig:1D:tsunami:hill">34</a>. The wave speed \( c=\sqrt{gH(x)} =
\sqrt{g(H_0-B(x))} \) will then be reduced in the shallow water above
the hill.

<p>
<center> <!-- figure label: --> <div id="wave:app:fig:1D:tsunami:hill"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 34:  Sketch of an earthquake-generated tsunami passing over a subsea hill.  <!-- caption label: wave:app:fig:1D:tsunami:hill --> </p></center>
<p><img src="fig-wave/earthquake_tsunami_hill.png" align="bottom" width=800></p>
</center>

<p>
One possible form of the
hill is a Gaussian function,

$$
\begin{equation}
B(x;B_0,B_a,B_m,B_s) =
B_0 + B_a\exp{\left(-\left(\frac{x-B_m}{B_s}\right)^2\right)},
\tag{330}
\end{equation}
$$

but many other shapes are also possible, e.g., a "cosine hat" where

$$
\begin{equation}
B(x; B_0, B_a, B_m, B_s) = B_0 + B_a\cos{\left( \pi\frac{x-B_m}{2B_s}\right)},
\tag{331}
\end{equation}
$$

when \( x\in [B_m - B_s, B_m + B_s] \) while \( B=B_0 \) outside this
interval.

<p>
Also an abrupt construction may be tried:
$$
\begin{equation}
B(x; B_0, B_a, B_m, B_s) = B_0 + B_a,
\tag{332}
\end{equation}
$$

for \( x\in [B_m - B_s, B_m + B_s] \) while \( B=B_0 \) outside this
interval.

<p>
The <a href="http://tinyurl.com/nu656p2/wave/wave1D/wave1D_dn_vc.py" target="_self"><tt>wave1D_dn_vc.py</tt></a>
program can be used as starting point for the implementation.
Visualize both the bottom topography and the
water surface elevation in
the same plot.
Allow for a flexible choice of bottom shape:
<a href="#mjx-eqn-330">(330)</a>,
<a href="#mjx-eqn-331">(331)</a>,
<a href="#mjx-eqn-332">(332)</a>, or \( B(x)=B_0 \) (flat).

<p>
The purpose of this problem is to explore the quality of the numerical
solution \( \eta^n_i \) for different shapes of the bottom obstruction.
The &quot;cosine hat&quot; and the box-shaped hills have abrupt changes in the
derivative of \( H(x) \) and are more likely to generate numerical noise
than the smooth Gaussian shape of the hill. Investigate if this is true.
Filename: <code>tsunami1D_hill</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:tsunami2D:hill">Problem 2.25: Earthquake-generated tsunami over a 3D hill</h2>

<p>
This problem extends <a href="#wave:app:exer:tsunami1D:hill">Problem 2.24: Earthquake-generated tsunami over a subsea hill</a>
to a three-dimensional wave phenomenon, governed by the 2D PDE

$$
\begin{equation}
\eta_{tt} = (gH\eta_x)_x + (gH\eta_y)_y = \nabla\cdot (gH\nabla\eta)
\tag{333}
\tp
\end{equation}
$$

We assume that the earthquake arises from a fault along the line \( x=0 \)
in the \( xy \)-plane so that the initial lift of the surface can be taken
as \( I(x) \) in <a href="#wave:app:exer:tsunami1D:hill">Problem 2.24: Earthquake-generated tsunami over a subsea hill</a>. That is, a
plane wave is propagating to the right, but will experience bending
because of the bottom.

<p>
The bottom shape is now a function of \( x \) and \( y \).  An &quot;elliptic&quot;
Gaussian function in two dimensions, with its peak at \( (B_{mx},
B_{my}) \), generalizes <a href="#mjx-eqn-330">(330)</a>:

$$
\begin{equation}
B =
B_0 + B_a\exp{\left(-\left(\frac{x-B_{mx}}{B_s}\right)^2
-\left(\frac{y-B_{my}}{bB_s}\right)^2\right)},
\tag{334}
\end{equation}
$$

where \( b \) is a scaling parameter: \( b=1 \) gives a circular Gaussian
function with circular contour lines, while \( b\neq 1 \) gives an elliptic
shape with elliptic contour lines. To indicate the input parameters in the
model, we may write

$$ B = B(x;B_0,B_a,B_{mx}, B_{my} ,B_s, b)\tp $$

<p>
The &quot;cosine hat&quot; <a href="#mjx-eqn-331">(331)</a> can also be
generalized to

$$
\begin{equation}
B =
B_0 + B_a\cos{\left( \pi\frac{x-B_{mx}}{2B_s}\right)}
\cos{\left( \pi\frac{y-B_{my}}{2B_s}\right)},
\tag{335}
\end{equation}
$$

when \( 0 \leq \sqrt{x^2+y^2} \leq B_s \) and \( B=B_0 \) outside this circle.

<p>
A box-shaped obstacle means that
$$
\begin{equation}
B(x; B_0, B_a, B_m, B_s, b) = B_0 + B_a
\tag{336}
\end{equation}
$$

for \( x \) and \( y \) inside a rectangle
$$ B_{mx}-B_s \leq  x \leq B_{mx} + B_s,\quad
B_{my}-bB_s \leq  y \leq B_{my} + bB_s,
$$

and \( B=B_0 \) outside this rectangle.
The \( b \) parameter controls the rectangular shape of the cross section of
the box.

<p>
Note that the initial condition and the listed bottom shapes are
symmetric around the line \( y=B_{my} \). We therefore expect the surface
elevation also to be symmetric with respect to this line.  This means
that we can halve the computational domain by working with
\( [0,L_x]\times [0, B_{my}] \). Along the upper boundary, \( y=B_{my} \), we
must impose the symmetry condition \( \partial \eta/\partial n=0 \).  Such
a symmetry condition (\( -\eta_x=0 \)) is also needed at the \( x=0 \)
boundary because the initial condition has a symmetry here. At the
lower boundary \( y=0 \) we also set a Neumann condition (which becomes
\( -\eta_y=0 \)).  The wave motion is to be simulated until the wave hits
the reflecting boundaries where \( \partial\eta/\partial n =\eta_x =0 \)
(one can also set \( \eta =0 \) - the particular condition does not matter
as long as the simulation is stopped before the wave is influenced
by the boundary condition).

<p>
Visualize the surface elevation.  Investigate how different hill shapes,
different sizes of the water gap above the hill, and different
resolutions \( \Delta x = \Delta y = h \) and \( \Delta t \) influence
the numerical quality of the solution.
Filename: <code>tsunami2D_hill</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:tsunami:hill:viz:matplotlib">Problem 2.26: Investigate Matplotlib for visualization</h2>

<p>
Play with native Matplotlib code for visualizing 2D
solutions of the wave equation with variable wave velocity.
See if there
are effective ways to visualize both the solution and the wave
velocity.
Filename: <code>tsunami2D_hill_mpl</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:tsunami:hill:viz:packages">Problem 2.27: Investigate visualization packages</h2>

<p>
Create some fancy 3D visualization of the water waves <em>and</em> the subsea hill
in <a href="#wave:app:exer:tsunami2D:hill">Problem 2.25: Earthquake-generated tsunami over a 3D hill</a>.
Try to make the hill transparent. Possible visualization tools are
<a href="http://code.enthought.com/projects/mayavi/" target="_self">Mayavi</a>,
<a href="http://www.paraview.org/" target="_self">Paraview</a>, and
<a href="http://www.opendx.org/" target="_self">OpenDX</a>.
Filename: <code>tsunami2D_hill_viz</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:tsunami2D:hill:compiled">Problem 2.28: Implement loops in compiled languages</h2>

<p>
Extend the program from <a href="#wave:app:exer:tsunami2D:hill">Problem 2.25: Earthquake-generated tsunami over a 3D hill</a> such
that the loops over mesh points, inside the time loop, are
implemented in compiled languages.
Consider implementations in
Cython, Fortran via <code>f2py</code>, C via Cython, C via <code>f2py</code>, C/C++ via Instant,
and C/C++ via <code>scipy.weave</code>.
Perform efficiency experiments to investigate the relative performance
of the various implementations. It is often advantageous to normalize
CPU times by the fastest method on a given mesh.
Filename: <code>tsunami2D_hill_compiled</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:seismic2D">Exercise 2.29: Simulate seismic waves in 2D</h2>

<p>
The goal of this exercise is to simulate seismic waves using the
PDE model <a href="._fdm-book-solarized010.html#mjx-eqn-297">(297)</a> in a
2D \( xz \) domain with geological layers.
Introduce \( m \) horizontal layers of thickness \( h_i \), \( i=0,\ldots,m-1 \).
Inside layer number \( i \) we have a vertical wave velocity \( c_{z,i} \)
and a horizontal wave velocity \( c_{h,i} \). Make a program
for simulating such 2D waves. Test it on a case with 3 layers where

$$ c_{z,0}=c_{z,1}=c_{z,2},\quad c_{h,0}=c_{h,2},\quad c_{h,1} \ll c_{h,0}
\tp
$$

Let \( s \) be a localized point source at the middle of the Earth's surface
(the upper boundary)
and investigate how the resulting wave travels through the medium.
The source can be a localized Gaussian peak that oscillates in
time for some time interval.
Place the boundaries far enough from the expanding wave so that the
boundary conditions do not disturb the wave. Then the type of
boundary condition does not matter, except that we physically need
to have \( p=p_0 \), where \( p_0 \) is the atmospheric pressure,
at the upper boundary.
Filename: <code>seismic2D</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:acoustics">Project 2.30: Model 3D acoustic waves in a room</h2>

<p>
The equation for sound waves in air is derived in the section <a href="._fdm-book-solarized010.html#wave:app:sound">Sound waves in liquids and gases</a>
and reads

$$ p_{tt} = c^2\nabla^2 p,$$

where \( p(x,y,z,t) \) is the pressure and \( c \)
is the speed of sound, taken as 340 m/s.
<!-- air at a room temperature 20 C, \( p_0 \) is reference pressure in the -->
<!-- air, typically 1 atm (approximately \( 10^5 \) Pa), and \( \varrho_0 \) is -->
<!-- the density of air, taken as \( 1.225\mbox{ kg/m}^3 \). -->
However, sound is absorbed in the air due to relaxation of molecules
in the gas. A model for simple relaxation, valid for gases consisting
only of one type of molecules, is a term \( c^2\tau_s\nabla^2 p_t \) in
the PDE, where \( \tau_s \) is the relaxation time. If we generate sound
from, e.g., a loudspeaker in the room, this sound source must also
be added to the governing equation.

<p>
The PDE with the mentioned type of damping and source then becomes

$$
\begin{equation}
p_tt = c^2\nabla^p + c^2\tau_s\nabla^2 p_t + f,
\tag{337}
\end{equation}
$$

where \( f(x,y,z,t) \) is the source term.

<p>
The walls can absorb some sound. A possible model is to have a &quot;wall layer&quot;
(thicker than the physical wall)
outside the room where \( c \) is changed such that some of the wave energy
is reflected and some is absorbed in the wall. The absorption of
energy can be taken care of by adding a damping term \( bp_t \) in
the equation:

$$
\begin{equation}
p_tt + bp_t = c^2\nabla^p + c^2\tau_s\nabla^2 p_t + f\tp
\tag{338}
\end{equation}
$$

Typically, \( b=0 \) in the room and \( b>0 \) in the wall. A discontinuity in \( b \)
or \( c \) will give rise to reflections. It can be wise to use a constant
\( c \) in the wall to control reflections because of the discontinuity between
\( c \) in the air and in the wall, while \( b \) is gradually increased
as we go into the wall to avoid reflections because of rapid changes in \( b \).
At the outer boundary of the wall the condition \( p=0 \) or \( \partial p/\partial n=0 \) can be imposed. The waves should anyway be approximately dampened
to \( p=0 \) this far out in the wall layer.

<p>
There are two strategies for discretizing the \( \nabla^2 p_t \) term: using
a center difference between times \( n+1 \) and \( n-1 \) (if the equation is
sampled at level \( n \)), or use a one-sided difference based on levels \( n \)
and \( n-1 \). The latter has the advantage of not leading to any equation system,
while the former is second-order accurate as the scheme for the
simple wave equation \( p_tt = c^2\nabla^2 p \). To avoid an equation system,
go for the one-sided difference such that the overall scheme becomes
explicit and only of first order in time.

<p>
Develop a 3D solver for the specified PDE and introduce a wall layer.
Test the solver with the method of manufactured solutions. Make some
demonstrations where the wall reflects and absorbs the waves (reflection
because of discontinuity in \( b \) and absorption because of growing \( b \)).
Experiment with the impact of the \( \tau_s \) parameter.
Filename: <code>acoustics</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:advec1D">Project 2.31: Solve a 1D transport equation</h2>

<p>
We shall study the wave equation

$$
\begin{equation}
u_t + cu_x = 0,\quad x\in (0,L],\ t\in (0, T],
\tag{339}
\end{equation}
$$

with initial condition

$$
\begin{equation}
u(x,0) = I(x),\quad x\in [0,L],
\tag{340}
\end{equation}
$$

and <em>one</em> periodic boundary condition

$$
\begin{equation}
u(0,t) = u(L,t)
\tp
\tag{341}
\end{equation}
$$

This boundary condition means that what goes out of the domain at \( x=L \)
comes in at \( x=0 \). Roughly speaking,
we need only one boundary condition because of
the spatial derivative is of first order only.

<p>
<b>Physical interpretation.</b>
The parameter \( c \) can be constant or variable, \( c=c(x) \). The
equation <a href="#mjx-eqn-339">(339)</a> arises in <em>transport</em>
problems where a quantity \( u \), which could be temperature or
concentration of some contaminant, is transported with the velocity
\( c \) of a fluid. In addition to the transport imposed by &quot;travelling with
the fluid&quot;, \( u \) may also be transported by diffusion (such as
heat conduction or Fickian diffusion), but we have in
the model \( u_t + cu_x \) assumed that diffusion effects are negligible,
which they often are.

<p>
<b>a)</b>
Show that under the assumption of \( a=\hbox{const} \),

$$
\begin{equation}
u(x,t) = I(x - ct)
\tag{342}
\end{equation}
$$

fulfills the PDE as well as the initial and boundary condition
(provided \( I(0)=I(L) \)).

<p>
A widely used numerical scheme for <a href="#mjx-eqn-339">(339)</a>
applies a forward difference in time and a backward difference in
space when \( c>0 \):

$$
\begin{equation}
[D_t^+ u + cD_x^-u = 0]_i^n
\tag{343}
\tp
\end{equation}
$$

For \( c < 0 \) we use a forward difference in space: \( [cD_x^+u]_i^n \).

<p>
<b>b)</b>
Set up a computational algorithm and implement it in a function.
Assume \( a \) is constant and positive.

<p>
<b>c)</b>
Test the implementation by using the remarkable property that
the numerical solution is exact at the mesh points if
\( \Delta t = c^{-1}\Delta x \).

<p>
<b>d)</b>
Make a movie comparing the numerical and exact solution for the
following two choices of initial conditions:

$$
\begin{equation}
 I(x) = \left\lbrack\sin\left(\pi\frac{x}{L}\right)\right\rbrack^{2n}
\tag{344}
\end{equation}
$$

where \( n \) is an integer, typically \( n=5 \),
and

$$
\begin{equation}
I(x) = \exp{\left( -\frac{(x-L/2)^2}{2\sigma2}\right)} \tp
\end{equation}
\tag{345}
$$

Choose \( \Delta t = c^{-1}\Delta x, 0.9c^{-1}\Delta x, 0.5c^{-1}\Delta x \).

<p>
<b>e)</b>
The performance of the suggested numerical scheme can be investigated
by analyzing the numerical dispersion relation.
Analytically, we have that the <em>Fourier component</em>

$$ u(x,t) = e^{i(kx-\omega t)},$$

is a solution of the PDE if \( \omega = kc \). This is the <em>analytical
dispersion relation</em>. A complete solution of the PDE can be built by
adding up such Fourier components with different amplitudes, where the
initial condition \( I \) determines the amplitudes. The solution \( u \) is
then represented by a Fourier series.

<p>
A similar discrete Fourier component at \( (x_p,t_n) \) is

$$ u_p^q = e^{i(kp\Delta x -\tilde\omega n\Delta t)},$$

where in general \( \tilde\omega \) is a function of \( k \), \( \Delta t \), and
\( \Delta x \), and differs from the exact \( \omega =kc \).

<p>
Insert the discrete Fourier component in the numerical scheme and
derive an expression for \( \tilde\omega \), i.e.,
the discrete dispersion relation. Show in particular that if
\( \Delta t/(c\Delta x)=1 \), the discrete solution coincides with the
exact solution at the mesh points, regardless of the mesh resolution (!).
Show that if the stability condition

$$ \frac{\Delta t}{c\Delta x}\leq 1,$$

the discrete Fourier component cannot grow (i.e., \( \tilde\omega \) is real).

<p>
<b>f)</b>
Write a test for your implementation where you try to use information
from the numerical dispersion relation.

<p>
We shall hereafter assume that \( c(x)>0 \).

<p>
<b>g)</b>
Set up a computational algorithm for the variable
coefficient case and implement it in a function.
Make a test that the function works for constant \( a \).

<p>
<b>h)</b>
It can be shown that
for an observer moving with velocity \( c(x) \), \( u \) is constant.
This can be used to derive an exact solution when \( a \) varies
with \( x \). Show first that

$$
\begin{equation}
u(x,t) = f(C(x) - t),
\tag{346}
\end{equation}
$$

where

$$ C'(x) = \frac{1}{c(x)},$$

is a solution of <a href="#mjx-eqn-339">(339)</a> for any
differentiable function \( f \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>i)</b>
Use the initial condition to show that an exact solution is

$$ u(x,t) = I(C^{-1}(C(x)-t)),$$

with \( C^{-1} \) being the inverse function of \( C = \int c^{1}dx \).
Since \( C(x) \) is an integral \( \int_0^x (1/c)dx \),
\( C(x) \) is monotonically increasing and there exists hence an
inverse function \( C^{-1} \) with values in \( [0,L] \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
To compute <a href="#mjx-eqn-346">(346)</a> we need to integrate
\( 1/c \) to obtain \( C \) and then compute the inverse of \( C \).

<p>
The inverse function computation can be easily done if we first think
discretely. Say we have some function \( y=g(x) \) and seek its inverse.
Plotting \( (x_i,y_i) \), where \( y_i=g(x_i) \) for some mesh points \( x_i \),
displays \( g \) as a function of \( x \).
The inverse function is simply \( x \) as a function of \( g \), i.e., the
curve with points \( (y_i,x_i) \). We can therefore quickly compute points
at the curve of the inverse function. One way of extending these
points to a continuous function is to assume a linear variation
(known as linear interpolation)
between the points (which actually means to draw straight lines between
the points, exactly as done by a plotting program).

<p>
The function <code>wrap2callable</code> in <code>scitools.std</code> can take a set of points
and return a continuous function that corresponds to linear
variation between the points. The computation of the inverse of a
function \( g \) on \( [0,L] \) can then be done by

<p>
<!-- begin verbatim block  pycod-->
<pre><code>def inverse(g, domain, resolution=101):
    x = linspace(domain[0], domain[L], resolution)
    y = g(x)
    from scitools.std import wrap2callable
    g_inverse = wrap2callable((y, x))
    return g_inverse
</code></pre>
<!-- end verbatim block -->

<p>
To compute \( C(x) \) we need to integrate \( 1/c \), which can be done by
a Trapezoidal rule. Suppose we have computed \( C(x_i) \) and need
to compute \( C(x_{i+1}) \). Using the Trapezoidal rule with \( m \) subintervals
over the integration domain \( [x_i,x_{i+1}] \) gives

$$
\begin{equation}
C(x_{i+1}) = C(x_i) + \int_{x_i}^{x_{i+1}} \frac{dx}{c}
\approx h\left(
\half\frac{1}{c(x_i)} + \half\frac{1}{c(x_{i+1})}
+ \sum_{j=1}^{m-1} \frac{1}{c(x_i + jh)}\right),
\tag{347}
\end{equation}
$$

where \( h=(x_{i+1}-x_i)/m \) is the length of the subintervals used
for the integral over \( [x_i,x_{i+1}] \).
We observe that <a href="#mjx-eqn-347">(347)</a> is a
<em>difference equation</em> which we can solve by repeatedly
applying <a href="#mjx-eqn-347">(347)</a> for
\( i=0,1,\ldots,N_x-1 \) if a mesh \( x_0,x_,\ldots,x_{N_x} \) is prescribed.
Note that \( C(0)=0 \).

<p>
<b>j)</b>
Implement a function for computing \( C(x_i) \) and one for computing
\( C^{-1}(x) \) for any \( x \). Use these two functions for computing
the exact solution \( I(C^{-1}(C(x)-t)) \).
End up with a function <code>u_exact_variable_c(x, n, c, I)</code> that returns
the value of \( I(C^{-1}(C(x)-t_n)) \).

<p>
<b>k)</b>
Make movies showing a comparison of the numerical and exact solutions
for the two initial conditions
<a href="#mjx-eqn-344">(344)</a> and <a href="#mjx-eqn-345">(345)</a>.
Choose \( \Delta t = \Delta x /\max_{0,L} c(x) \)
and the velocity of the medium as

<ol>
<li> \( c(x) = 1 + \epsilon\sin(k\pi x/L) \), \( \epsilon < 1 \),</li>
<li> \( c(x) = 1 + I(x) \), where \( I \) is given by
   <a href="#mjx-eqn-344">(344)</a> or <a href="#mjx-eqn-345">(345)</a>.</li>
</ol>

The PDE \( u_t + cu_x=0 \) expresses that the initial condition \( I(x) \)
is transported with velocity \( c(x) \).

<p>
Filename: <code>advec1D</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:anal:damped:wave1D">Problem 2.32: General analytical solution of a 1D damped wave equation</h2>

<p>
We consider an initial-boundary value problem for the damped wave equation:

$$
\begin{align*}
u_{tt} +bu_t &= c^2 u_{xx}, \quad &x\in (0,L),\ t\in (0,T]\\ 
u(0,t) &= 0,\\ 
u(L,t) &=0,\\ 
u(x, 0) &= I(x),\\ 
u_t(x, 0) &= V(x)\tp
\end{align*}
$$

Here, \( b\geq 0 \) and \( c \) are given constants. The aim is to derive a general
analytical solution of this problem. Familiarity with the method of
separation of variables for solving PDEs will be assumed.

<p>
<b>a)</b>
Seek a solution on the form \( u(x,t)=X(x)T(t) \). Insert this solution in
the PDE and show that it leads to two differential equations for \( X \) and \( T \):

$$ T'' + bT' + \lambda T = 0,\quad c^2 X'' +\lambda X = 0, $$

with \( X(0)=X(L)=0 \) as boundary conditions, and \( \lambda \) as a constant
to be determined.

<p>
<b>b)</b>
Show that \( X(x) \) is on the form

$$ X_n(x) = C_n\sin kx,\quad k = \frac{n\pi}{L},\quad n=1,2,\ldots$$

where \( C_n \) is an arbitrary constant.

<p>
<!-- lambda = k**2 -->

<p>
<b>c)</b>
Under the assumption that \( (b/2)^2 < k^2 \), show that \( T(t) \) is on
the form

$$ T_n(t) = e^{-{\half}bt}(a_n\cos\omega t + b_n\sin\omega t),
\quad\omega = \sqrt{k^2 - \frac{1}{4}b^2},\quad n=1,2,\ldots $$

The complete solution is then

$$ u(x,t) = \sum_{n=1}^\infty \sin kx e^{-{\half}bt}(
A_n\cos\omega t + B_n\sin\omega t),$$

where the constants \( A_n \) and \( B_n \) must be computed from the initial
conditions.

<p>
<b>d)</b>
Derive a formula for \( A_n \) from \( u(x,0)=I(x) \) and developing \( I(x) \) as a sine
Fourier series on \( [0,L] \).

<p>
<b>e)</b>
Derive a formula for \( B_n \) from \( u_t(x,0)=V(x) \) and developing \( V(x) \) as
a sine Fourier series on \( [0,L] \).

<p>
<b>f)</b>
Calculate \( A_n \) and \( B_n \) from vibrations of a string where \( V(x)=0 \) and

$$
\begin{equation}
I(x) = \left\lbrace
\begin{array}{ll}
ax/x_0, & x < x_0,\\ 
a(L-x)/(L-x_0), & \hbox{otherwise}
\end{array}\right.
\tag{348}
\end{equation}
$$

<p>
<b>g)</b>
Implement the series for \( u(x,t) \) in a function <code>u_series(x, t, tol=1E-10)</code>,
where <code>tol</code> is a tolerance for truncating the series. Simply sum
the terms until \( |a_n| \) and \( |b_b| \) both are less than <code>tol</code>.

<p>
<b>h)</b>
What will change in the derivation of the analytical solution if we
have \( u_x(0,t)=u_x(L,t)=0 \) as boundary conditions?
And how will you solve the problem with \( u(0,t)=0 \) and \( u_x(L,t)=0 \)?

<p>
<!-- sin goes to cos, k changes as cos(kL)=0 -->

<p>
Filename: <code>damped_wave1D</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:anal:damped:wave2D">Problem 2.33: General analytical solution of a 2D damped wave equation</h2>

<p>
Carry out <a href="#wave:app:exer:anal:damped:wave1D">Problem 2.32: General analytical solution of a 1D damped wave equation</a> in the 2D
case: \( u_{tt}+bu_t = c^2(u_{xx}+u_{yy}) \), where \( (x,y)\in (0,L_x)\times
(0,L_y) \). Assume a solution on the form \( u(x,y,t)=X(x)Y(y)T(t) \).
Filename: <code>damped_wave2D</code>.

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._fdm-book-solarized010.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._fdm-book-solarized012.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

