
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Wave equations</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Finite Difference Computing with Partial Differential Equations" href="index.html" />
    <link rel="next" title="Diffusion equations" href="._book025.html" />
    <link rel="prev" title="Vibration ODEs" href="._book023.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book025.html" title="Diffusion equations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book023.html" title="Vibration ODEs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Finite Difference Computing with Partial Differential Equations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="wave-equations-2">
<h1>Wave equations<a class="headerlink" href="#wave-equations-2" title="Permalink to this headline">¶</a></h1>
<div class="section" id="linear-wave-equation-in-1d">
<span id="trunc-wave-1d"></span><h2>Linear wave equation in 1D<a class="headerlink" href="#linear-wave-equation-in-1d" title="Permalink to this headline">¶</a></h2>
<p>The standard, linear wave equation in 1D for a function <span class="math">\(u(x,t)\)</span> reads</p>
<div class="math" id="eq-trunc-wave-pde1d">
\[\tag{711}
\frac{\partial^2 u}{\partial t^2} = c^2\frac{\partial^2 u}{\partial x^2} + f(x,t),\quad x\in (0, L),\ t\in (0,T],\]</div>
<p>where <span class="math">\(c\)</span> is the constant wave velocity of the physical medium in <span class="math">\([0,L]\)</span>.
The equation can also be more compactly written as</p>
<div class="math" id="eq-trunc-wave-pde1d-v2">
\[\tag{712}
u_{tt} = c^2u_{xx} + f,\quad x\in (0, L),\ t\in (0,T],\]</div>
<p>Centered, second-order finite differences are a natural choice for
discretizing the derivatives, leading to</p>
<div class="math" id="eq-trunc-wave-pde1d-fd">
\[ \begin{align}\begin{aligned}\tag{713}
[D_t D_t u = c^2 D_xD_x u + f]^n_i\\    {\thinspace .}\end{aligned}\end{align} \]</div>
<p>Inserting the exact solution <span class="math">\({u_{\small\mbox{e}}}(x,t)\)</span> in <a class="reference internal" href="#eq-trunc-wave-pde1d-fd"><span class="std std-ref">(713)</span></a>
makes this function fulfill the equation if we add the
term <span class="math">\(R\)</span>:</p>
<div class="math" id="eq-trunc-wave-pde1d-fd-r">
\[\tag{714}
[D_t D_t {u_{\small\mbox{e}}} = c^2 D_xD_x {u_{\small\mbox{e}}} + f + R]^n_i\]</div>
<p>Our purpose is to calculate the truncation error <span class="math">\(R\)</span>.
From <a class="reference internal" href="._book021.html#eq-trunc-table-fd2-center-eq"><span class="std std-ref">(660)</span></a>-<a class="reference internal" href="._book021.html#eq-trunc-table-fd2-center"><span class="std std-ref">(661)</span></a> we have that</p>
<div class="math">
\[[D_t D_t{u_{\small\mbox{e}}}]_i^n = {u_{\small\mbox{e}, tt}}(x_i,t_n) +
\frac{1}{12}{u_{\small\mbox{e}, tttt}}(x_i,t_n)\Delta t^2 + {\mathcal{O}(\Delta t^4)},\]</div>
<p>when we use a notation taking into account that <span class="math">\({u_{\small\mbox{e}}}\)</span> is a function
of two variables and that derivatives must be partial derivatives.
The notation <span class="math">\({u_{\small\mbox{e}, tt}}\)</span> means <span class="math">\(\partial^2{u_{\small\mbox{e}}} /\partial t^2\)</span>.</p>
<p>The same formula may also be applied to the <span class="math">\(x\)</span>-derivative term:</p>
<div class="math">
\[[D_xD_x{u_{\small\mbox{e}}}]_i^n = {u_{\small\mbox{e}, xx}}(x_i,t_n) +
\frac{1}{12}{u_{\small\mbox{e}, xxxx}}(x_i,t_n)\Delta x^2 + {\mathcal{O}(\Delta x^4)},\]</div>
<p>Equation <a class="reference internal" href="#eq-trunc-wave-pde1d-fd-r"><span class="std std-ref">(714)</span></a> now becomes</p>
<div class="math">
\[\begin{split}\begin{align*}
{u_{\small\mbox{e}, tt}}
+ \frac{1}{12}{u_{\small\mbox{e}, tttt}}(x_i,t_n)\Delta t^2  &amp;=
c^2{u_{\small\mbox{e}, xx}} +
c^2\frac{1}{12}{u_{\small\mbox{e}, xxxx}}(x_i,t_n)\Delta x^2 + f(x_i,t_n) + \\
&amp; \quad  {\mathcal{O}(\Delta t^4,\Delta x^4)} + R^n_i
{\thinspace .}
\end{align*}\end{split}\]</div>
<p>Because <span class="math">\({u_{\small\mbox{e}}}\)</span> fulfills the partial differential equation (PDE)
<a class="reference internal" href="#eq-trunc-wave-pde1d-v2"><span class="std std-ref">(712)</span></a>, the first, third, and fifth term cancel out,
and we are left with</p>
<div class="math" id="eq-trunc-wave-1d-r">
\[\tag{715}
R^n_i = \frac{1}{12}{u_{\small\mbox{e}, tttt}}(x_i,t_n)\Delta t^2 -
    c^2\frac{1}{12}{u_{\small\mbox{e}, xxxx}}(x_i,t_n)\Delta x^2 +
    {\mathcal{O}(\Delta t^4,\Delta x^4)},\]</div>
<p>showing that the scheme <a class="reference internal" href="#eq-trunc-wave-pde1d-fd"><span class="std std-ref">(713)</span></a> is of second order
in the time and space mesh spacing.</p>
</div>
<div class="section" id="finding-correction-terms">
<span id="trunc-wave-1d-corr"></span><h2>Finding correction terms<a class="headerlink" href="#finding-correction-terms" title="Permalink to this headline">¶</a></h2>
<p>Can we add correction terms to the PDE and increase the order of
<span class="math">\(R^n_i\)</span> in <a class="reference internal" href="#eq-trunc-wave-1d-r"><span class="std std-ref">(715)</span></a>? The starting point is</p>
<div class="math" id="eq-trunc-wave-pde1d-fd-r2">
\[\tag{716}
[D_t D_t {u_{\small\mbox{e}}} = c^2 D_xD_x {u_{\small\mbox{e}}} + f + C + R]^n_i\]</div>
<p>From the previous analysis we simply get <a class="reference internal" href="#eq-trunc-wave-1d-r"><span class="std std-ref">(715)</span></a>
again, but now with <span class="math">\(C\)</span>:</p>
<div class="math" id="eq-trunc-wave-1d-r-c">
\[\tag{717}
R^n_i + C_i^n = \frac{1}{12}{u_{\small\mbox{e}, tttt}}(x_i,t_n)\Delta t^2 -
    c^2\frac{1}{12}{u_{\small\mbox{e}, xxxx}}(x_i,t_n)\Delta x^2 +
    {\mathcal{O}(\Delta t^4,\Delta x^4)}{\thinspace .}\]</div>
<p>The idea is to let <span class="math">\(C_i^n\)</span> cancel the <span class="math">\(\Delta t^2\)</span> and <span class="math">\(\Delta x^2\)</span>
terms to make <span class="math">\(R^n_i = {\mathcal{O}(\Delta t^4,\Delta x^4)}\)</span>:</p>
<div class="math">
\[C_i^n =
\frac{1}{12}{u_{\small\mbox{e}, tttt}}(x_i,t_n)\Delta t^2 -
c^2\frac{1}{12}{u_{\small\mbox{e}, xxxx}}(x_i,t_n)\Delta x^2{\thinspace .}\]</div>
<p>Essentially, it means that we add a new term</p>
<div class="math">
\[C = \frac{1}{12}\left( u_{tttt}\Delta t^2 - c^2u_{xxxx}\Delta x^2\right),\]</div>
<p>to the right-hand side of the PDE.
We must either discretize these 4th-order derivatives directly or
rewrite them in terms of lower-order derivatives with the aid of the
PDE. The latter approach is more feasible. From the PDE we have the
operator equality</p>
<div class="math">
\[\frac{\partial^2}{\partial t^2} = c^2\frac{\partial^2}{\partial x^2},\]</div>
<p>so</p>
<div class="math">
\[u_{tttt} = c^2u_{xxtt},\quad u_{xxxx} = c^{-2}u_{ttxx}{\thinspace .}\]</div>
<p>Assuming <span class="math">\(u\)</span> is smooth enough, so that <span class="math">\(u_{xxtt}=u_{ttxx}\)</span>, these relations
lead to</p>
<div class="math">
\[C = \frac{1}{12}((c^2\Delta t^2 - \Delta x^2)u_{xx})_{tt}{\thinspace .}\]</div>
<p>A natural discretization is</p>
<div class="math">
\[C^n_i = \frac{1}{12}((c^2\Delta t^2 - \Delta x^2)
[D_xD_xD_tD_t u]^n_i{\thinspace .}\]</div>
<p>Writing out <span class="math">\([D_xD_xD_tD_t u]^n_i\)</span> as
<span class="math">\([D_xD_x (D_tD_t u)]^n_i\)</span> gives</p>
<div class="math">
\[\begin{split}\begin{align*}
\frac{1}{\Delta t^2}\biggl(
&amp;\frac{u^{n+1}_{i+1} - 2u^{n}_{i+1} + u^{n-1}_{i+1}}{\Delta x^2} -2\\
&amp;\frac{u^{n+1}_{i} - 2u^{n}_{i} + u^{n-1}_{i}}{\Delta x^2} +
&amp;\frac{u^{n+1}_{i-1} - 2u^{n}_{i-1} + u^{n-1}_{i-1}}{\Delta x^2}
\biggr)
\end{align*}\end{split}\]</div>
<p>Now the unknown values <span class="math">\(u^{n+1}_{i+1}\)</span>, <span class="math">\(u^{n+1}_{i}\)</span>,
and <span class="math">\(u^{n+1}_{i-1}\)</span> are <em>coupled</em>, and we must solve a tridiagonal
system to find them. This is in principle straightforward, but it
results in an implicit finite difference schemes, while we had
a convenient explicit scheme without the correction terms.</p>
</div>
<div class="section" id="extension-to-variable-coefficients-2">
<span id="trunc-wave-1d-varcoeff"></span><h2>Extension to variable coefficients<a class="headerlink" href="#extension-to-variable-coefficients-2" title="Permalink to this headline">¶</a></h2>
<p>Now we address the variable coefficient version of the linear 1D
wave equation,</p>
<div class="math">
\[\frac{\partial^2 u}{\partial t^2} = \frac{\partial}{\partial x}
\left( \lambda(x)\frac{\partial u}{\partial x}\right),\]</div>
<p>or written more compactly as</p>
<div class="math" id="eq-trunc-wave-1d-varcoeff-pde">
\[\tag{718}
u_{tt} = (\lambda u_x)_x{\thinspace .}\]</div>
<p>The discrete counterpart to this equation, using arithmetic mean for
<span class="math">\(\lambda\)</span> and centered differences, reads</p>
<div class="math" id="eq-trunc-wave-1d-varcoeff-fd">
\[\tag{719}
[D_t D_t u = D_x \overline{\lambda}^{x}D_x u]^n_i{\thinspace .}\]</div>
<p>The truncation error is the residual <span class="math">\(R\)</span> in the equation</p>
<div class="math" id="eq-trunc-wave-1d-varcoef-fd-r">
\[\tag{720}
[D_t D_t {u_{\small\mbox{e}}} = D_x \overline{\lambda}^{x}D_x {u_{\small\mbox{e}}} + R]^n_i{\thinspace .}\]</div>
<p>The difficulty with <a class="reference internal" href="#eq-trunc-wave-1d-varcoef-fd-r"><span class="std std-ref">(720)</span></a>
is how to compute the truncation error of
the term <span class="math">\([D_x \overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}]^n_i\)</span>.</p>
<p>We start by writing out the outer operator:</p>
<div class="math" id="eq-trunc-wave-1d-varcoeff-outer">
\[\tag{721}
[D_x \overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}]^n_i =
    \frac{1}{\Delta x}\left(
    [\overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}]^n_{i+\frac{1}{2}} -
    [\overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}]^n_{i-\frac{1}{2}}
    \right).\]</div>
<p>With the aid of <a class="reference internal" href="._book021.html#eq-trunc-table-fd1-center-eq"><span class="std std-ref">(648)</span></a>-<a class="reference internal" href="._book021.html#eq-trunc-table-fd1-center"><span class="std std-ref">(649)</span></a>
and <a class="reference internal" href="._book021.html#eq-trunc-table-avg-arith-eq"><span class="std std-ref">(664)</span></a>-<a class="reference internal" href="._book021.html#eq-trunc-table-avg-arith"><span class="std std-ref">(665)</span></a> we have</p>
<div class="math">
\[\begin{split}\begin{align*}
\lbrack D_x {u_{\small\mbox{e}}} \rbrack^n_{i+\frac{1}{2}} &amp; = {u_{\small\mbox{e}, x}}(x_{i+\frac{1}{2}},t_n) +
\frac{1}{24}{u_{\small\mbox{e}, xxx}}(x_{i+\frac{1}{2}},t_n)\Delta x^2 +
{\mathcal{O}(\Delta x^4)},\\
\lbrack\overline{\lambda}^{x}\rbrack_{i+\frac{1}{2}}
&amp;= \lambda(x_{i+\frac{1}{2}}) +
\frac{1}{8}\lambda''(x_{i+\frac{1}{2}})\Delta x^2
+ {\mathcal{O}(\Delta x^4)},\\
[\overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}]^n_{i+\frac{1}{2}} &amp;=
(\lambda(x_{i+\frac{1}{2}}) +
\frac{1}{8}\lambda''(x_{i+\frac{1}{2}})\Delta x^2
+ {\mathcal{O}(\Delta x^4)})\times\\
&amp;\quad ({u_{\small\mbox{e}, x}}(x_{i+\frac{1}{2}},t_n) +
\frac{1}{24}{u_{\small\mbox{e}, xxx}}(x_{i+\frac{1}{2}},t_n)\Delta x^2 +
{\mathcal{O}(\Delta x^4)})\\
&amp;= \lambda(x_{i+\frac{1}{2}}){u_{\small\mbox{e}, x}}(x_{i+\frac{1}{2}},t_n)
+ \lambda(x_{i+\frac{1}{2}})
\frac{1}{24}{u_{\small\mbox{e}, xxx}}(x_{i+\frac{1}{2}},t_n)\Delta x^2 + \\
&amp;\quad {u_{\small\mbox{e}, x}}(x_{i+\frac{1}{2}})
\frac{1}{8}\lambda''(x_{i+\frac{1}{2}})\Delta x^2
+{\mathcal{O}(\Delta x^4)}\\
&amp;= [\lambda {u_{\small\mbox{e}, x}}]^n_{i+\frac{1}{2}} + G^n_{i+\frac{1}{2}}\Delta x^2
+{\mathcal{O}(\Delta x^4)},
\end{align*}\end{split}\]</div>
<p>where we have introduced the short form</p>
<div class="math">
\[G^n_{i+\frac{1}{2}} =
(\frac{1}{24}{u_{\small\mbox{e}, xxx}}(x_{i+\frac{1}{2}},t_n)\lambda((x_{i+\frac{1}{2}})
+ {u_{\small\mbox{e}, x}}(x_{i+\frac{1}{2}},t_n)
\frac{1}{8}\lambda''(x_{i+\frac{1}{2}}))\Delta x^2{\thinspace .}\]</div>
<p>Similarly, we find that</p>
<div class="math">
\[\lbrack\overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}\rbrack^n_{i-\frac{1}{2}} =
[\lambda {u_{\small\mbox{e}, x}}]^n_{i-\frac{1}{2}} + G^n_{i-\frac{1}{2}}\Delta x^2
+{\mathcal{O}(\Delta x^4)}{\thinspace .}\]</div>
<p>Inserting these expressions in the outer operator <a class="reference internal" href="#eq-trunc-wave-1d-varcoeff-outer"><span class="std std-ref">(721)</span></a>
results in</p>
<div class="math">
\[\begin{split}\begin{align*}
\lbrack D_x \overline{\lambda}^{x}D_x {u_{\small\mbox{e}}} \rbrack^n_i &amp;=
\frac{1}{\Delta x}(
[\overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}]^n_{i+\frac{1}{2}} -
[\overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}]^n_{i-\frac{1}{2}}
)\\
&amp;= \frac{1}{\Delta x}(
[\lambda {u_{\small\mbox{e}, x}}]^n_{i+\frac{1}{2}} +
G^n_{i+\frac{1}{2}}\Delta x^2 -
[\lambda {u_{\small\mbox{e}, x}}]^n_{i-\frac{1}{2}} -
G^n_{i-\frac{1}{2}}\Delta x^2 +
{\mathcal{O}(\Delta x^4)}
)\\
&amp;= [D_x \lambda {u_{\small\mbox{e}, x}}]^n_i + [D_x G]^n_i\Delta x^2 + {\mathcal{O}(\Delta x^4)}{\thinspace .}
\end{align*}\end{split}\]</div>
<p>The reason for <span class="math">\({\mathcal{O}(\Delta x^4)}\)</span> in the remainder is that there
are coefficients in front of this term, say <span class="math">\(H\Delta x^4\)</span>, and the
subtraction and division by <span class="math">\(\Delta x\)</span> results in <span class="math">\([D_x H]^n_i\Delta x^4\)</span>.</p>
<p>We can now use <a class="reference internal" href="._book021.html#eq-trunc-table-fd1-center-eq"><span class="std std-ref">(648)</span></a>-<a class="reference internal" href="._book021.html#eq-trunc-table-fd1-center"><span class="std std-ref">(649)</span></a>
to express the <span class="math">\(D_x\)</span> operator
in <span class="math">\([D_x \lambda {u_{\small\mbox{e}, x}}]^n_i\)</span>
as a derivative and a truncation error:</p>
<div class="math">
\[[D_x \lambda {u_{\small\mbox{e}, x}}]^n_i =
\frac{\partial}{\partial x}\lambda(x_i){u_{\small\mbox{e}, x}}(x_i,t_n)
+ \frac{1}{24}(\lambda{u_{\small\mbox{e}, x}})_{xxx}(x_i,t_n)\Delta x^2
+ {\mathcal{O}(\Delta x^4)}{\thinspace .}\]</div>
<p>Expressions like <span class="math">\([D_x G]^n_i\Delta x^2\)</span> can be treated in an identical
way,</p>
<div class="math">
\[[D_x G]^n_i\Delta x^2 = G_x(x_i,t_n)\Delta x^2
+ \frac{1}{24}G_{xxx}(x_i,t_n)\Delta x^4 + {\mathcal{O}(\Delta x^4)}{\thinspace .}\]</div>
<p>There will be a number of terms with the <span class="math">\(\Delta x^2\)</span> factor. We
lump these now into <span class="math">\({\mathcal{O}(\Delta x^2)}\)</span>.
The result of the truncation error analysis of the spatial derivative
is therefore summarized as</p>
<div class="math">
\[[D_x \overline{\lambda}^{x}D_x {u_{\small\mbox{e}}}]^n_i =
\frac{\partial}{\partial x}
\lambda(x_i){u_{\small\mbox{e}, x}}(x_i,t_n) +
{\mathcal{O}(\Delta x^2)}{\thinspace .}\]</div>
<p>After having treated the <span class="math">\([D_tD_t{u_{\small\mbox{e}}}]^n_i\)</span> term as well, we achieve</p>
<div class="math">
\[R^n_i = {\mathcal{O}(\Delta x^2)} +
\frac{1}{12}{u_{\small\mbox{e}, tttt}}(x_i,t_n)\Delta t^2
{\thinspace .}\]</div>
<p>The main conclusion is that the scheme is of second-order in time
and space also in this variable coefficient case. The key ingredients
for second order are the centered differences and the arithmetic
mean for <span class="math">\(\lambda\)</span>: all those building blocks feature second-order accuracy.</p>
</div>
<div class="section" id="d-wave-equation-on-a-staggered-mesh">
<h2>1D wave equation on a staggered mesh<a class="headerlink" href="#d-wave-equation-on-a-staggered-mesh" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="linear-wave-equation-in-2d-3d">
<span id="trunc-wave-2d"></span><h2>Linear wave equation in 2D/3D<a class="headerlink" href="#linear-wave-equation-in-2d-3d" title="Permalink to this headline">¶</a></h2>
<p>The two-dimensional extension of <a class="reference internal" href="#eq-trunc-wave-pde1d"><span class="std std-ref">(711)</span></a> takes the form</p>
<div class="math" id="eq-trunc-wave-pde2d">
\[\tag{722}
\frac{\partial^2 u}{\partial t^2} = c^2\left(\frac{\partial^2 u}{\partial x^2}
    + \frac{\partial^2 u}{\partial y^2}\right) + f(x,y,t),\quad (x,y)\in (0, L)\times (0,H),\ t\in (0,T],\]</div>
<p>where now <span class="math">\(c(x,y)\)</span> is the constant wave velocity of the physical medium
<span class="math">\([0,L]\times [0,H]\)</span>. In the compact notation, the PDE
<a class="reference internal" href="#eq-trunc-wave-pde2d"><span class="std std-ref">(722)</span></a> can be written</p>
<div class="math" id="eq-trunc-wave-pde2d-v2">
\[\tag{723}
u_{tt} = c^2(u_{xx} + u_{yy}) + f(x,y,t),\quad (x,y)\in (0, L)\times (0,H),
    \ t\in (0,T],\]</div>
<p>in 2D, while the 3D version reads</p>
<div class="math" id="eq-trunc-wave-pde3d-v2">
\[\tag{724}
u_{tt} = c^2(u_{xx} + u_{yy} + u_{zz}) + f(x,y,z,t),\]</div>
<p>for <span class="math">\((x,y,z)\in (0, L)\times (0,H)\times (0,B)\)</span> and
<span class="math">\(t\in (0,T]\)</span>.</p>
<p>Approximating the second-order derivatives by the standard
formulas <a class="reference internal" href="._book021.html#eq-trunc-table-fd2-center-eq"><span class="std std-ref">(660)</span></a>-<a class="reference internal" href="._book021.html#eq-trunc-table-fd2-center"><span class="std std-ref">(661)</span></a>
yields the scheme</p>
<div class="math" id="eq-auto264">
\[\tag{725}
[D_t D_t u = c^2(D_xD_x u + D_yD_y u) + f]^n_{i,j,k}
    {\thinspace .}\]</div>
<p>The truncation error is found from</p>
<div class="math" id="eq-auto265">
\[\tag{726}
[D_t D_t {u_{\small\mbox{e}}} = c^2(D_xD_x {u_{\small\mbox{e}}} + D_yD_y {u_{\small\mbox{e}}}) + f + R]^n
    {\thinspace .}\]</div>
<p>The calculations from the 1D case can be repeated to the
terms in the <span class="math">\(y\)</span> and <span class="math">\(z\)</span> directions. Collecting terms that
fulfill the PDE, we end up with</p>
<div class="math" id="eq-auto266">
\[\tag{727}
R^n_{i,j,k}  = [\frac{1}{12}{u_{\small\mbox{e}, tttt}}\Delta t^2 -
    c^2\frac{1}{12}\left( {u_{\small\mbox{e}, xxxx}}\Delta x^2
    + {u_{\small\mbox{e}, yyyy}}\Delta x^2
    + {u_{\small\mbox{e}, zzzz}}\Delta z^2\right)]^n_{i,j,k} +\]</div>
<div class="math">
\[\quad {\mathcal{O}(\Delta t^4,\Delta x^4,\Delta y^4,\Delta z^4)}\nonumber
{\thinspace .}\]</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Wave equations</a><ul>
<li><a class="reference internal" href="#linear-wave-equation-in-1d">Linear wave equation in 1D</a></li>
<li><a class="reference internal" href="#finding-correction-terms">Finding correction terms</a></li>
<li><a class="reference internal" href="#extension-to-variable-coefficients-2">Extension to variable coefficients</a></li>
<li><a class="reference internal" href="#d-wave-equation-on-a-staggered-mesh">1D wave equation on a staggered mesh</a></li>
<li><a class="reference internal" href="#linear-wave-equation-in-2d-3d">Linear wave equation in 2D/3D</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book023.html"
                        title="previous chapter">Vibration ODEs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book025.html"
                        title="next chapter">Diffusion equations</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/._book024.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book025.html" title="Diffusion equations"
             >next</a> |</li>
        <li class="right" >
          <a href="._book023.html" title="Vibration ODEs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Finite Difference Computing with Partial Differential Equations</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;2016, Hans Petter Langtangen, Svein Linge. Released under CC Attribution 4.0 license.
  </div>
</div>

  </body>
</html>