
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Operator splitting methods</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Solving nonlinear ODE and PDE problems" href="index.html" />
    <link rel="next" title="Exercises" href="._main_nonlin007.html" />
    <link rel="prev" title="Multi-dimensional PDE problems" href="._main_nonlin005.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._main_nonlin007.html" title="Exercises"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._main_nonlin005.html" title="Multi-dimensional PDE problems"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Solving nonlinear ODE and PDE problems</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="operator-splitting-methods">
<span id="nonlin-splitting"></span><h1>Operator splitting methods<a class="headerlink" href="#operator-splitting-methods" title="Permalink to this headline">¶</a></h1>
<p>Operator splitting is a natural and old idea. When a PDE or system of PDEs
contains different terms expressing different physics, it is natural to
use different numerical methods for different physical processes. This can
optimize and simplify the overall solution process. The idea was
especially popularized in the context of the Navier-Stokes equations
and reaction-diffusion PDEs. Common names for the technique are <em>operator
splitting</em>, <em>fractional step</em> methods, and <em>split-step</em> methods. We shall
stick to the former name.
In the context of nonlinear differential equations, operator splitting
can be used to isolate nonlinear terms and simplify the solution methods.</p>
<p>A related technique, often known as dimensional splitting or
alternating direction implicit (ADI) methods, is to split the spatial
dimensions and solve a 2D or 3D problem as two or three
consecutive 1D problems, but this type of splitting
is not to be further considered here.</p>
<div class="section" id="ordinary-operator-splitting-for-odes">
<span id="nonlin-splitting-ode"></span><h2>Ordinary operator splitting for ODEs<a class="headerlink" href="#ordinary-operator-splitting-for-odes" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><p id="index-2">Consider first an ODE where the right-hand side is split into two
terms:</p>
<div class="math" id="eq-auto32">
\[\tag{71}
u' = f_0(u) + f_1(u){\thinspace .}\]</div>
<p>In case <span class="math">\(f_0\)</span> and <span class="math">\(f_1\)</span> are linear functions of <span class="math">\(u\)</span>, <span class="math">\(f_0=au\)</span> and <span class="math">\(f_1=bu\)</span>,
we have <span class="math">\(u(t)=Ie^{(a+b)t}\)</span>, if <span class="math">\(u(0)=I\)</span>.
When going one time step of length <span class="math">\(\Delta t\)</span> from <span class="math">\(t_n\)</span> to <span class="math">\(t_{n+1}\)</span>, we have</p>
<div class="math">
\[u(t_{n+1}) = u(t_n)e^{(a+b)\Delta t}{\thinspace .}\]</div>
<p>This expression can be also be written as</p>
<div class="math">
\[u(t_{n+1}) = u(t_n)e^{a\Delta t}e^{b\Delta t},\]</div>
<p>or</p>
<div class="math" id="eq-nonlin-splitting-ode-step1">
\[\tag{72}
u^* = u(t_n)e^{a\Delta t},\]</div>
<div class="math" id="eq-nonlin-splitting-ode-step2">
\[\tag{73}
u(t_{n+1}) = u^*e^{b\Delta t}\]</div>
<p>The first step <a class="reference internal" href="#eq-nonlin-splitting-ode-step1"><span class="std std-ref">(72)</span></a> means solving
<span class="math">\(u'=f_0\)</span> over a time interval <span class="math">\(\Delta t\)</span> with <span class="math">\(u(t_n)\)</span> as start value.
The second step <a class="reference internal" href="#eq-nonlin-splitting-ode-step2"><span class="std std-ref">(73)</span></a> means solving
<span class="math">\(u'=f_1\)</span> over a time interval <span class="math">\(\Delta t\)</span> with the value at the end
of the first step as start value.
That is, we progress the solution in two steps and solve
two ODEs <span class="math">\(u'=f_1\)</span> ad <span class="math">\(u'=f_2\)</span>. The order of the equations is not
important. From the derivation above we see that solving <span class="math">\(u'=f_1\)</span>
prior to <span class="math">\(u'=f_0\)</span> can equally well be done.</p>
<p>The technique is exact if the ODEs are linear. For nonlinear ODEs it is
only an approximate method with error <span class="math">\(\Delta t\)</span>. The technique can
be extended to <span class="math">\(n+1\)</span> steps:</p>
<div class="math">
\[u' = \sum_{i=0}^n f_i(u),\]</div>
<p>which is solved by <span class="math">\(n+1\)</span> steps over <span class="math">\([t_n, t_{n+1}]\)</span>:</p>
<div class="math">
\[\begin{split}\frac{du^{(0)}}{dt} &amp;= f_0(u^{(0)}),\quad u^{(0)}(t_n)=u(t_n),\\
\frac{du^{(i)}}{dt} &amp;= f_i(u^{(i)}),\quad u^{(i)}(t_n)=u^{(i-1)}(t_{n+1}),\\\end{split}\]</div>
<p>for <span class="math">\(i=1,\ldots,n\)</span>. We take the final solution
<span class="math">\(u(t_{n+1})\)</span> as <span class="math">\(u^{(n)}(t_{n+1})\)</span>.</p>
</div>
<div class="section" id="strang-splitting-for-odes">
<span id="nonlin-splitting-ode-strang"></span><h2>Strang splitting for ODEs<a class="headerlink" href="#strang-splitting-for-odes" title="Permalink to this headline">¶</a></h2>
<p id="index-3">The accuracy of the splitting method in the section <a class="reference internal" href="#nonlin-splitting-ode"><span class="std std-ref">Ordinary operator splitting for ODEs</span></a>
can be improved from <span class="math">\({\mathcal{O}(\Delta t)}\)</span> to <span class="math">\({\mathcal{O}(\Delta t^2)}\)</span> using so-called
<em>Strang splitting</em>, where we take half a step with the <span class="math">\(f_1\)</span> operator,
a full step with the <span class="math">\(f_2\)</span> operator, and finally half another step with
the <span class="math">\(f_1\)</span> operator. During a time interval <span class="math">\(\Delta t\)</span> the algorithm can
be written as follows.</p>
<div class="math">
\[\begin{split}\frac{du^{(0)}}{dt} &amp;= f_0(u^{(0)}),\quad u^{(0)}(t_n)=u(t_n),
\quad t\in [0,\frac{1}{2}\Delta t],\\
\frac{du^{(\frac{1}{2})}}{dt} &amp;= f_1(u^{(\frac{1}{2})}),\quad u^{(\frac{1}{2})}(t_n)=u^{(0)}(t_{n+\frac{1}{2}}),
\quad t\in [0,\Delta t],\\
\frac{du^{(1)}}{dt} &amp;= f_0(u^{(1)}),\quad u^{(1)}(t_n)=u^{(\frac{1}{2})}(t_{n+1})
{\thinspace .}\\\end{split}\]</div>
<p>There is no use in applying higher-order methods when performing
ordinary splitting since the error due to splitting is <span class="math">\(\Oof{\Delta
t}\)</span>, but for Strang splitting it makes sense to use schemes of order
<span class="math">\({\mathcal{O}(\Delta t^2)}\)</span>.</p>
</div>
<div class="section" id="example-logistic-growth">
<h2>Example: Logistic growth<a class="headerlink" href="#example-logistic-growth" title="Permalink to this headline">¶</a></h2>
<p>Let us split the (scaled) logistic equation</p>
<div class="math">
\[u'=u(1-u),\quad u'(0)=0.1,\]</div>
<p>with solution <span class="math">\(u=(9e^{-t}+1)^{-1}\)</span>, into</p>
<div class="math">
\[u'=u - u^2 = f_0(u) + f_1(u), \quad f_0(u)=u,\quad f_1(u)=-u^2{\thinspace .}\]</div>
<p>We solve <span class="math">\(u'=f_0(u)\)</span> and <span class="math">\(u'=f_2(u)\)</span> by a Forward Euler step.
In addition, we add a method where we solve <span class="math">\(u'=f_0(u)\)</span> analytically,
since the equation is actually <span class="math">\(u'=u\)</span> with solution <span class="math">\(e^t\)</span>.</p>
<p>The following function computes four solutions arising from the Forward
Euler method, ordinary splitting, Strang splitting, as well as Strang splitting
with exact treatment of <span class="math">\(u'=f_0(u)\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">solver</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve u&#39;=f by the Forward Euler method and by ordinary and</span>
<span class="sd">    Strang splitting: f(u) = f_1(u) + f_2(u).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">dt</span><span class="p">)))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nt</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">Nt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">u_FE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">u_split1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c"># 1st-order splitting</span>
    <span class="n">u_split2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c"># 2nd-order splitting</span>
    <span class="n">u_split3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c"># 2nd-order splitting w/exact f_0</span>

    <span class="c"># Set initial values</span>
    <span class="n">u_FE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">u_split1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">u_split2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">u_split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c"># Forward Euler method</span>
        <span class="n">u_FE</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_FE</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">u_FE</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>

        <span class="c"># Ordinary splitting</span>
        <span class="n">u_0</span> <span class="o">=</span> <span class="n">u_split1</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f_0</span><span class="p">(</span><span class="n">u_split1</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
        <span class="n">u_split1</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f_1</span><span class="p">(</span><span class="n">u_0</span><span class="p">)</span>

        <span class="c"># Strang splitting</span>
        <span class="n">u_0</span> <span class="o">=</span> <span class="n">u_split2</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">f_0</span><span class="p">(</span><span class="n">u_split2</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
        <span class="n">u_1</span> <span class="o">=</span> <span class="n">u_0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f_1</span><span class="p">(</span><span class="n">u_0</span><span class="p">)</span>
        <span class="n">u_split2</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_1</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">f_0</span><span class="p">(</span><span class="n">u_1</span><span class="p">)</span>

        <span class="c"># Strang splitting using exact integrator for u&#39;=f_0</span>
        <span class="n">u_0</span> <span class="o">=</span> <span class="n">u_split3</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>  <span class="c"># exact</span>
        <span class="n">u_1</span> <span class="o">=</span> <span class="n">u_0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f_1</span><span class="p">(</span><span class="n">u_0</span><span class="p">)</span>
        <span class="n">u_split3</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">u_FE</span><span class="p">,</span> <span class="n">u_split1</span><span class="p">,</span> <span class="n">u_split2</span><span class="p">,</span> <span class="n">u_split3</span><span class="p">,</span> <span class="n">t</span>
</pre></div>
</div>
<p>Figure <a class="reference internal" href="#nonlin-splitting-ode-logistic-fig"><span class="std std-ref">Effect of ordinary and Strang splitting for the logistic equation</span></a> shows that the impact
of splitting is significant. The Forward Euler method is much more accurate
than any of the splitting schemes. We also see that Strang splitting is
definitely more accurate than ordinary splitting and that it helps a bit
to use an exact solution of <span class="math">\(u'=f_0(u)\)</span>. As technique for solving
nonlinear ODEs, we realize that the present example is not particularly
illustrating, as the Forward Euler method both linearizes the original
problem and provides a solution that is more accurate than the splitting.</p>
<div class="figure" id="id1">
<span id="nonlin-splitting-ode-logistic-fig"></span><a class="reference internal image-reference" href="_images/split_logistic.png"><img alt="_images/split_logistic.png" src="_images/split_logistic.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-text"><em>Effect of ordinary and Strang splitting for the logistic equation</em></span></p>
</div>
</div>
<div class="section" id="reaction-diffusion-equation">
<h2>Reaction-diffusion equation<a class="headerlink" href="#reaction-diffusion-equation" title="Permalink to this headline">¶</a></h2>
<p>Consider a diffusion equation coupled to chemical reactions modeled by
a nonlinear term <span class="math">\(f(u)\)</span>:</p>
<div class="math">
\[\frac{\partial u}{\partial t} = {\alpha}\nabla^2 + f(u){\thinspace .}\]</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Operator splitting methods</a><ul>
<li><a class="reference internal" href="#ordinary-operator-splitting-for-odes">Ordinary operator splitting for ODEs</a></li>
<li><a class="reference internal" href="#strang-splitting-for-odes">Strang splitting for ODEs</a></li>
<li><a class="reference internal" href="#example-logistic-growth">Example: Logistic growth</a></li>
<li><a class="reference internal" href="#reaction-diffusion-equation">Reaction-diffusion equation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._main_nonlin005.html"
                        title="previous chapter">Multi-dimensional PDE problems</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._main_nonlin007.html"
                        title="next chapter">Exercises</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/._main_nonlin006.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._main_nonlin007.html" title="Exercises"
             >next</a> |</li>
        <li class="right" >
          <a href="._main_nonlin005.html" title="Multi-dimensional PDE problems"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Solving nonlinear ODE and PDE problems</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;H. P. Langtangen.
  </div>
</div>

  </body>
</html>